\documentclass{amsart}

\usepackage{amsmath,amssymb,amsfonts}
\usepackage[all]{xy}
\usepackage{appendix,listings,hyperref}

\DeclareMathOperator{\rank}{rk}
\DeclareMathOperator{\trace}{tr}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Sym}{Sym}
\DeclareMathOperator{\Hilb}{Hilb}

\newcommand{\hilb}[1]{^{[#1]}}
\newcommand{\ie}{{\it i.e. }}
\newcommand{\eg}{{\it e.g. }}
\newcommand{\loccit}{{\it loc. cit. }}
\newcommand{\vac}{|0\rangle}
\newcommand{\odd}{{\rm{odd}}}
\newcommand{\even}{{\rm{even}}}
\newcommand{\tors}{{\rm{tors}}}

\newcommand{\p}[2]{p_{#1}^{#2}\;\!\!}
\renewcommand{\L}{\mathcal{L}}

\newcommand{\coloneqq}{:=}
\newcommand{\bra}{\left<\!\!\!\:\left<}
\newcommand{\ket}{\right>\!\!\!\:\right>}
\newcommand{\myeq}[1]{\mathrel{\overset{\makebox[0pt]{\text{\tiny #1}}}{=}}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\C}{\mathbb{C}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\Z}{\mathbb{Z}}
\renewcommand{\S}{\mathbb{S}}
\renewcommand{\H}{\mathbb{H}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\kS}{\mathfrak{S}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\lra}{\longrightarrow}
\newcommand{\ra}{\rightarrow}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{notation}[theorem]{Notation}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\title[Symmetric Powers, Hom.~Orth.~Polynomials, Hyperk\"ahlers]{Symmetric Powers of Symmetric Bilinear Forms, Homogeneous Orthogonal Polynomials on the Sphere and an Application in Compact Hyperk\"ahler Manifolds}


\author{Simon Kapfer}
\address{Simon Kapfer, Laboratoire de Math\'ematiques et Applications, UMR CNRS 6086, Universit\'e de Poitiers, T\'el\'eport 2, Boulevard Marie et Pierre Curie, F-86962 Futuroscope Chasseneuil}
\email{simon.kapfer@math.univ-poitiers.fr}
%\urladdr{http://www.math.uni-augsburg.de/alg/}


\date{\today}

\keywords{Orthogonal Polynomials in Several Variables, Homogeneous Polynomials, Hermite Polynomials, Hyperk\"ahler Manifolds, Beauville-Bogomolov Form, Fujiki relation}

\begin{abstract} 
We do technical stuff!
\end{abstract}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Symmetric Bilinear Forms on Symmetric Powers}
Let $V$ be a vector space (or, more generally, a free module) over $K$ of rank $d$ with basis $\{e_0,\ldots,e_{d-1}\}$, equipped with a symmetric bilinear form $\left<\,\ ,\ \right>: V\times V \rightarrow K$. There are
are at least two possibilities to define an induced bilinear form on the symmetric power $\Sym^kV$. The first one is to define on the induced basis of $\Sym^kV$
\begin{equation}\label{Garr}
\left< e_{i_1}\ldots e_{i_k}, e_{j_1}\ldots e_{i_k}\right> \coloneqq \sum_\sigma  
\prod_{n=1}^k \left< e_{i_n},e_{j_{\sigma(n)}}\right>,
\end{equation}
the sum being over all permutations of $\{1,\ldots,k\}$, as studied by McGarraghy in \cite{McGarr}. However, we will \emph{not} consider 
this construction. Instead, we make the following
\begin{definition} \label{formdef} On the basis $\{e_{i_1}\ldots e_{i_k}\;|\;0\leq i_1\leq\ldots\leq i_k<d\}$ of $\Sym^kV$, we define a symmetric bilinear form $\bra\ \,,\ \ket$ by: 
\begin{equation}
\label{mydef}
\bra e_{i_1}\ldots e_{i_k}\,,\,e_{i_{k+1}}\ldots e_{i_{2k}} \ket \coloneqq \sum_{\mathcal{P}} \prod_{\{a,b\}\in\mathcal{P}} \left<e_{i_a},e_{i_b}\right>,
\end{equation}
where the sum is over all partitions $\mathcal{P}$ of $\{1,\ldots,2k\}$ into pairs.
\end{definition}
Observe that if $U\in O(V)$ is an orthogonal transformation, then the induced diagonal action of $U^{\otimes k}$ on $\Sym^kV$ is orthogonal in both cases. This shows that the two definitions are independent of the choice of the base.

\begin{example}
To contrast the two definitions, observe that in the case $k=2$
\begin{align}
\left<ab,cd\right> &= \left<a,c\right>\left<b,d\right>+\left<a,d\right>\left<b,c\right>, \\
\bra ab,cd\ket &= \left<a,c\right>\left<b,d\right>+\left<a,d\right>\left<b,c\right> + \left<a,b\right>\left<c,d\right>.
\end{align}
\end{example}
\begin{remark}
Note that (\ref{Garr}) does not require symmetry of the bilinear form $\left<\,\ ,\ \right>$ on $V$. Indeed, the definition would also be valid for a completely arbitrary bilinear form~$: V\times W \rightarrow K$, yielding a bilinear form $:\Sym^kV\times\Sym^kW\rightarrow K$. On the other hand, if the form on $V$ is not symmetric, then (\ref{mydef}) is not well-defined.
\end{remark}
\begin{remark}
The defining equation (\ref{mydef}) works equally well, if the two arguments have different degree. So we can easily extend our definition to a symmetric bilinear form~$\bra\ \,,\ \ket:\Sym^*V\times\Sym^*V \rightarrow K$. Note that then $\Sym^kV$ is in general not orthogonal to $\Sym^lV$ unless $k-l \equiv 1 \mod{2}$.
\end{remark}
We wish to investigate some properties of this construction. First of all, in the case $K=\R$, the obvious isomorphism
\begin{equation*}
\Sym^* V \cong \R\!\left[x_0,\ldots,x_{d-1}\right]
\end{equation*}


\section{Homogeneous Orthogonal Polynomials on the sphere}
In this section we will construct a basis for the space of homogeneous polynomials of degree $k$ in $d+1$ variables, $\R[x_0,\ldots,x_d]_k$, that is orthogonal with respect to the bilinear form given by
\begin{equation*}
 \bra f,g\ket = \int_{\R^{d+1}}f(x)g(x) d\mu(x),
\end{equation*}
where the measure is $d\mu(x) = (2\pi)^{-\frac{d+1}{2}}e^{-\frac{1}{2}\|x\|^2}dx$. In order to do this, we wish to apply the Gram-Schmidt process to the (lexicographically ordered) monomial basis $(x^\alpha)_{|\alphaÂ |=k}$. Our result is stated in Subsection \ref{hsection}. 
\begin{remark}
In view of Lemma \ref{homosphere}, we could equivalently integrate the homogeneous polynomials over the unit sphere $\S^d$. That is the reason why we call them orthogonal on the sphere.
\end{remark}
\begin{remark}
 If the homogeneity constraint was dropped, the answer to the problem would be much simpler: A basis of $ \bra\ ,\;\ket$-orthogonal polynomials is given by products $H_{\alpha_0}\!(x_0)\ldots H_{\alpha_d}\!(x_d)$ of Hermite polynomials in one variable, see also \cite[Sect.~2.3.4]{Dunkl}.
\end{remark}
\subsection{Some formulas}
We give a few basic definitions and recall some facts on elementary calculus which we will need in the sequel. The reader may also consult \cite{Folland}.
\begin{definition}
For a multi-index $\alpha=(\alpha_0,\ldots,\alpha_d)$ we define: $x^\alpha \coloneqq x_0^{\alpha_0}\ldots x_d^{\alpha_d}$. The degree is defined by $|\alpha |\coloneqq\sum\alpha_i$, the factorial is $\alpha! \coloneqq \prod \alpha_i!$. Further, we set
$\alpha'\coloneqq(\alpha_0,\ldots,\alpha_{d-1})$. We introduce the lexicographical ordering on multi-indices: $\alpha < \beta$ iff $\alpha_d < \beta_d$ or $(\alpha_d=\beta_d) \wedge (\alpha'<\beta')$.
\end{definition}
Denote $\Gamma(t)$ the gamma function. It satisfies:
\begin{align}
n!&=\Gamma(n+1),\qquad (2n-1)!!\sqrt{\pi} =2^{n}\Gamma\left(n+\tfrac{1}{2}\right), \\
\label{doublegamma}
n!&\sqrt{\pi}=2^{n}\Gamma\left(\tfrac{n}{2}+1\right)\Gamma\left(\tfrac{n+1}{2}\right) ,\\
\int_0^\infty& r^se^{-\frac{1}{2}r^2} dr = 2^{\frac{s-1}{2}}\Gamma\left(\tfrac{s+1}{2}\right).
\end{align}
Using symmetry, it follows immediately that:
\begin{align}    \label{monoint}
 \int_{\R^{d+1}}x^\alpha x^\beta & e^{-\frac{1}{2}\|x\|^2} dx = \ \ 
\displaystyle \prod_{i=0}^d \int_{-\infty}^\infty x_i^{\alpha_i+\beta_i} e^{-\frac{1}{2}x_i^2} dx_i \\
 &= \left\{
\begin{array}{*2{l}p{5cm}}
(2 \pi)^{\frac{d+1}{2}}\prod_{i=0}^d (\alpha_i+\beta_i-1)!! &\text{if all }\alpha_i+\beta_i\text{ are even}, \vspace{0.2cm} \\ 
 0 &\text{otherwise}.
\end{array}
  \right.\nonumber
\end{align}

\begin{lemma}\label{homosphere}
Let $f:\R^{n+1}\rightarrow\R$ be an integrable homogeneous function of degree $k$, that is $f(sx) = s^kf(x)$. Using polar coordinates $(r,\omega) = (\|x\|,\frac{x}{\|x\|})$, we get:
\begin{align*}
\int_{\R^{d+1}}f(x)e^{-\frac{1}{2}\|x\|^2} dx &= \int_{\S^d}\!\int_0^\infty\! f(r\omega) r^d e^{-\frac{1}{2}r^2}dr d\omega \\
&= 2^{\frac{k+d-1}{2}}\Gamma\left(\tfrac{k+d+1}{2}\right)\int_{\S^d}f(\omega)d\omega .
\end{align*}
\end{lemma}


\subsection{Generalities on orthogonal polynomials}
\begin{theorem}[Favard's theorem] \label{favard}
Let $(p_n)_n$ be a sequence of polynomials, such that $\deg p_n =n$ and the following three-term recurrence holds:
$$p_0(x) = 1,\qquad  p_{n+1}(x) = (x-c_n)p_n(x) - d_np_{n-1}(x).
$$
Then there exists a unique linear functional $\L$ such that $\L(1)=1$ and $\L(p_np_{n'})=0$ for $n\neq n'$. Moreover, for $n\geq 1$ we have: $\L(p_n^2) = d_n\L(p_{n-1}^2)$.
\end{theorem}



\subsection{A polynomial family}
\begin{definition} Let $n,\ m$ be integers with $0\leq 2n\leq m+1$, a condition that we always will assume silently. We define polynomials $\p{n}{m}$ of degree $n$:
\begin{equation}
\p{n}{m}(x) \coloneqq \sum_{\substack{l=0\\ n-l\ \text{even}}}^n \frac{n!\,(m-2n)!!\,(-1)^{\frac{n-l}{2}}}{l!\,(m-n-l)!!\,(n-l)!!}\;x^l.
\end{equation}
\end{definition}
It is straightforward to check that the following two identities hold.
\begin{lemma} \label{trigonometric}
For $n\geq 1$, we have a trigonometric differential relation:
\begin{equation}
\frac{d}{d\omega} \Big[\p{n-1}{m-2}\big(\tan(\omega)\big)\cos(\omega)^{m-1} \Big]= (n-m)\, \p{n}{m}\big(\tan(\omega)\big)\cos(\omega)^{m-1}
\end{equation} \qed
\end{lemma}
\begin{proposition} \label{threeterm} For $0\leq 2n\leq m+1$, we have a three-term recurrence:
\begin{equation}
\p{0}{m}(x) = 1,\qquad \p{1}{m}(x) = x, \qquad \p{n+1}{m}(x) = x\p{n}{m}(x) -d_n^m \p{n-1}{m}(x),
\end{equation} 
where $d_n^m\coloneqq \frac{n(m-n+1)}{(m-2n)(m-2n+2)}$.\qed
\end{proposition}
\begin{theorem} \label{pthm}We define, for $m\geq 1$, a linear functional $\L$ on the vector space of polynomials of degree less than $m$, by setting
\begin{equation}
\L: f \longmapsto \int_0^\infty\!\!\! \int_{-\infty}^\infty z^{m-1}f\left(\frac{y}{z}\right) e^{-\frac{y^2+z^2}{2}} dydz.
\end{equation}
Then the $\p{n}{m}$ form a set of orthogonal polynomials with respect to the induced bilinear form, \ie $\L(\p{k}{m}\p{n}{m})=0$ for $k\neq n$ and 
\begin{equation} \label{Lpn2}
\L(\p{n}{m}\p{n}{m}) = 2^{\frac{3}{2}m-\frac{1}{2}-2n}  \frac{n!}{(m-n)!}
\Gamma\left(\frac{m}{2}-n\right)\Gamma\left(\frac{m}{2}-n+1\right)\Gamma\left(\frac{m+1}{2}\right).
\end{equation}
\end{theorem}
\begin{proof}
Since $\p{n}{m}$ satisfy the three-term relation in Prop.~\ref{threeterm}, by Favard's theorem, there exists a unique\footnote{Despite the fact that Favard's theorem is stated in a slightly different situation, namely for an infinite family of polynomials, the functional $\L'$ is unique on the space of poly of degree less than $\frac{m-1}{2}$.} functional $\L'$ with $\L'(1)=1$, such that the $\p{n}{m}$ form an orthogonal basis with respect to the bilinear form induced by $\L'$. We claim that $\L$ is a scalar multiple of $\L'$.
Since $(\p{n}{m})_{n} $ is a basis of the space of polynomials, we must show that, for $n\geq 1$, $\L(\p{n}{m}) = \L(\p{n}{m}\p{0}{m}) =0$.
Using polar coordinates $(y,z) = (r\cos\omega,r\sin\omega)$ and Lemma \ref{trigonometric}, we get:
\begin{align*}
\L(\p{n}{m}) &= \int_0^\pi\!\!\int_0^\infty r^m\sin(\omega)^{m-1} \p{n}{m}\left(\tfrac{\cos\omega}{\sin\omega}\right)e^{-\frac{r^2}{2}}dr d\omega \\
&=\int_0^\infty r^m e^{-\frac{r^2}{2}}dr \int_{\frac{\pi}{2}}^{\frac{3\pi}{2}} (-1)^n \cos(\omega)^{m-1}\p{n}{m}\big(\tan(\omega)\big)d\omega\\
&= 2^{\frac{m-1}{2}}\Gamma\left(\tfrac{m+1}{2}\right)\Big[\tfrac{(-1)^n}{n-m}p_{n-1}^{m-2}\big(\tan(\omega)\big)\cos(\omega)^{m-1} \Big]_{\frac{\pi}{2}}^{\frac{3\pi}{2}} =0,
\end{align*}
while $\L(1) = 2^{\frac{m-1}{2}}\sqrt{\pi}\,\Gamma\!\left(\frac{m}{2}\right)=2^{\frac{3m-1}{2}}  \frac{1}{m!}
\Gamma\left(\frac{m}{2}\right)\Gamma\left(\frac{m}{2}+1\right)\Gamma\left(\frac{m+1}{2}\right)$ by (\ref{monoint}) and (\ref{doublegamma}). To verify that equation (\ref{Lpn2}) holds for $n\geq 1$, too, check that the right hand side satisfies $\L(\p{n}{m}\p{n}{m}) = d_n^m\L(\p{n-1}{m}\p{n-1}{m})$, the second information from Favard's theorem. 
\end{proof}
\begin{corollary} \label{pcor}
 $\L(x^{k}\p{n}{m}) = 0$ for $k < n$ and $\L(x^n\p{n}{m})= \L(\p{n}{m}\p{n}{m})$.
\end{corollary}
\begin{proof}
The first assertion is established by the theorem in the case $k=0$. Now the three-term recurrence from Proposition \ref{threeterm} allows us to inductively conclude that $\L(x^k\p{n}{m}) = \L(x^{k-1}\p{n+1}{m})+d_n^m\L(x^{k-1}\p{n-1}{m}) =0$. The second assertion is trivial in the case $n\leq 1$. For $n\geq 1$, the same argument as above yields now $\L(x^n\p{n}{m}) = \L(x^{n-1}\p{n+1}{m})+d_n^m\L(x^{n-1}\p{n-1}{m})=d_n^m\L(x^{n-1}\p{n-1}{m})$, so $\L(x^n\p{n}{m})$ and $\L(\p{n}{m}\p{n}{m})$ must be equal because they satisfy the same recurrence relation.
\end{proof}



\subsection{Homogeneous orthogonal polynomials} \label{hsection}
We are now ready to give the desired basis of homogeneous polynomials that are orthogonal on the sphere. Inspired by the procedure for spherical harmonics, see \cite[p.~35]{Dunkl}, we make the following
\begin{definition} \label{hdef}
For multi-indices $\alpha=(\alpha_0,\ldots,\alpha_d)$ we recursively define homogeneous polynomials $h_\alpha$ of degree $|\alpha |$ by $h_{(\alpha_0)}(x) \coloneqq x_0^{\alpha_0}$ and, for $d\geq 1$,
$$
h_\alpha(x) \coloneqq \p{\alpha_d}{2|\alpha |+d}\left(\frac{x_d}{r}\right) r^{\alpha_d}h_{\alpha'}(x'),
$$
where we have set $r=\sqrt{x_0^2 +\ldots+x_{d-1}^2}=\|x'\|$.
\end{definition}
\begin{theorem} Fix a degree $k$.
Then the $h_\alpha(x),\ |\alpha|=k$ form an orthogonal basis of $\R[x_0,\ldots,x_d]_k$ that comes from a Gram--Schmidt process applied to the monomials. More precisely, we have:
\begin{align} \label{hth1}
\bra h_\alpha ,h_\alpha \ket &= 2^{|\alpha '|+|\alpha |+d}\,
\frac{\alpha_d!\,\Gamma\!\left(|\alpha '|+\frac{d}{2}+1\right)\Gamma\!\left(|\alpha |+\frac{d+1}{2}\right)}{\sqrt{\pi}\,\left(|\alpha '|+|\alpha |+d\right)!}\bra h_{\alpha '},h_{\alpha '}\ket ,\\
\label{hth2}
\bra h_\alpha,h_\beta \ket &= 0 \quad\text{for }\alpha\neq\beta,\\
\label{hth3}
\bra x^\alpha, h_\alpha \ket &= \bra h_\alpha ,h_\alpha \ket ,\\
\label{hth4}
\bra x^\alpha,h_\beta \ket &= 0 \quad\text{for }\alpha < \beta.
\end{align}
\end{theorem}
\begin{proof}
For equation (\ref{hth1}), we use polar coordinates on $\R ^d$ to compute:
\begin{align*}
 &\int_{\R^{d+1}}\left[\p{\alpha_d}{2|\alpha|+d}\left(\frac{x_d}{r}\right) r^{\alpha_d}h_{\alpha'}(x)\right]^2 e^{-\frac{1}{2}\|x\|^2} dx \\
 = & \int_0^\infty\!\!\int_{\R} \left[\p{\alpha_d}{2|\alpha|+d}\left(\frac{x_d}{r}\right)\right]^2 r^{2|\alpha'|+2\alpha_d+d-1} e^{-\frac{r^2+x_d^2}{2} }dx_ddr\int_{\S^{d-1}}\left[h_{\alpha'}(\omega)\right]^2 d\omega \\
\myeq{(\ref{Lpn2})}& \  \frac{\alpha_d!\, 2^{2|\alpha '|+|\alpha|+\frac{3}{2}d-\frac{1}{2}} }{\left(|\alpha|+|\alpha'|+d\right)!} { \textstyle
\Gamma\!\left( |\alpha'| \!+\!\frac{d}{2}\right)\Gamma\!\left( |\alpha'|\!+\! \frac{d}{2}\!+\! 1\right) \Gamma\!\left( |\alpha| \!+\! \frac{d+1}{2}\right) }\int_{\S^{d-1}}\!\!\left[h_{\alpha'}(\omega)\right]^2 d\omega \\
\myeq{Lemma \ref{homosphere}}&\quad\quad 2^{|\alpha '|+|\alpha |+d+\frac{1}{2}}\,
\frac{\alpha_d!\;\Gamma\!\left(|\alpha '|\!+\!\frac{d}{2}\!+\!1\right)\Gamma\!\left(|\alpha |\!+\!\tfrac{d+1}{2}\right)}{\left(|\alpha '|+|\alpha |+d\right)!} \int_{\R^d} \left[h_{\alpha'}(x')\right]^2 dx'.
\end{align*}
For the proof of (\ref{hth2}), we may assume that $\alpha_d \neq \beta_d$. Then we use the calculation above to see that Thm. \ref{pthm} now implies the vanishing of the integral. Equations (\ref{hth3}) and (\ref{hth4}) follow from Corollary \ref{pcor} in the same way.
\end{proof}





\section{Application in Hyperk\"ahler geometry}
Let $X$ be a compact Hyperk\"ahler manifold of complex dimension $2n$.

\bibliographystyle{amsplain}
\bibliography{SymBil.tex}


\end{document}

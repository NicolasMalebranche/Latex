\documentclass{amsart}

\usepackage{amsmath,amssymb,amsfonts}
\usepackage[all]{xy}
\usepackage{appendix,listings,hyperref}

\DeclareMathOperator{\rank}{rk}
\DeclareMathOperator{\trace}{tr}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Sym}{Sym}
\DeclareMathOperator{\Hilb}{Hilb}

\newcommand{\hilb}[1]{^{[#1]}}
\newcommand{\ie}{{\it i.e. }}
\newcommand{\eg}{{\it e.g. }}
\newcommand{\loccit}{{\it loc. cit. }}
\newcommand{\vac}{|0\rangle}
\newcommand{\odd}{{\rm{odd}}}
\newcommand{\even}{{\rm{even}}}
\newcommand{\tors}{{\rm{tors}}}

\newcommand{\p}[2]{p_{#1}^{#2}\;\!\!}
\renewcommand{\L}{\mathcal{L}}

\newcommand{\coloneqq}{:=}
\newcommand{\bra}{\left<\!\!\!\:\left<}
\newcommand{\ket}{\right>\!\!\!\:\right>}
\newcommand{\myeq}[1]{\mathrel{\overset{\makebox[0pt]{\text{\tiny #1}}}{=}}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\G}{\mathbb{G}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\Z}{\mathbb{Z}}
\renewcommand{\S}{\mathbb{S}}
\renewcommand{\H}{\mathbb{H}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\kS}{\mathfrak{S}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\lra}{\longrightarrow}
\newcommand{\ra}{\rightarrow}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{notation}[theorem]{Notation}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\title[Symmetric Powers, Hom.~Orth.~Polynomials, Hyperk\"ahlers]{Symmetric Powers of Symmetric Bilinear Forms, Homogeneous Orthogonal Polynomials on the Sphere and an Application in Compact Hyperk\"ahler Manifolds}


\author{Simon Kapfer}
\address{Simon Kapfer, Laboratoire de Math\'ematiques et Applications, UMR CNRS 6086, Universit\'e de Poitiers, T\'el\'eport 2, Boulevard Marie et Pierre Curie, F-86962 Futuroscope Chasseneuil}
\email{simon.kapfer@math.univ-poitiers.fr}
%\urladdr{http://www.math.uni-augsburg.de/alg/}


\date{\today}

\keywords{Orthogonal Polynomials in Several Variables, Hankel matrix, Homogeneous Polynomials, Hermite Polynomials, Hyperk\"ahler Manifolds, Beauville--Bogomolov Form, Beauville--Fujiki relation}

\begin{abstract} 
We do technical stuff!
\end{abstract}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Symmetric Bilinear Forms on Symmetric Powers}
Let $V$ be a vector space (or a free module) over a field (resp.~a commutative ring) $K$ of rank $d+1$ with basis $\{e_0,\ldots,e_{d}\}$, equipped with a symmetric bilinear form $\left<\,\ ,\ \right>: V\times V \rightarrow K$. There
are at least two possibilities to define an induced bilinear form on the symmetric power $\Sym^kV$. The first one is to define on the induced basis of $\Sym^kV$
\begin{equation}\label{Garr}
\left< e_{\alpha_1}\ldots e_{\alpha_k}, e_{\beta_1}\ldots e_{\beta_k}\right> \coloneqq \sum_\sigma  
\prod_{i=1}^k \left< e_{\alpha_i},e_{\beta_{\sigma(i)}}\right>,
\end{equation}
the sum being over all permutations of $\{1,\ldots,k\}$, as studied by McGarraghy in \cite{McGarr}. However, we will \emph{not} consider 
this construction. Instead, we make the following
\begin{definition} \label{formdef} On the basis $\{e_{\alpha_1}\ldots e_{\alpha_k}\;|\;0\leq \alpha_1\leq\ldots\leq \alpha_k\leq d\}$ of $\Sym^kV$, we define a symmetric bilinear form $\bra\ \,,\ \ket$ by: 
\begin{equation}
\label{mydef}
\bra e_{\alpha_1}\ldots e_{\alpha_k}\,,\,e_{\alpha_{k+1}}\ldots e_{\alpha_{2k}} \ket \coloneqq \sum_{\mathcal{P}} \prod_{\{i,j\}\in\mathcal{P}} \left<e_{\alpha_i},e_{\alpha_j}\right>,
\end{equation}
where the sum is over all partitions $\mathcal{P}$ of $\{1,\ldots,2k\}$ into pairs.
\end{definition}
If $U\in O(V)$ is an orthogonal transformation, then the induced diagonal action of $U^{\otimes k}$ on $\Sym^kV$ is orthogonal in both cases. This shows that the two definitions are independent of the choice of the base of $V$. 
For later reference, please note that the number of partitions of $\{1,\ldots,2k\}$ into pairs is given by the double factorial $(2k-1)!! = (2k-1)(2k-3)(2k-5)\ldots = \frac{(2k)!}{2^kk!}$.
\begin{example}
To contrast the two definitions, observe that in the case $k=2$
\begin{align}
\left<ab,cd\right> &= \left<a,c\right>\left<b,d\right>+\left<a,d\right>\left<b,c\right>, \\
\bra ab,cd\ket &= \left<a,c\right>\left<b,d\right>+\left<a,d\right>\left<b,c\right> + \left<a,b\right>\left<c,d\right>.
\end{align}
\end{example}
\begin{remark}
Note that (\ref{Garr}) does not require symmetry of the bilinear form $\left<\,\ ,\ \right>$ on $V$. Indeed, the definition would also be valid for a completely arbitrary bilinear form~$: V\times W \rightarrow K$, yielding a bilinear form $:\Sym^kV\times\Sym^kW\rightarrow K$. On the other hand, if the form on $V$ is not symmetric, then (\ref{mydef}) is not well-defined.
\end{remark}
\begin{remark}
The defining equation (\ref{mydef}) works equally well, if the two arguments have different degree. So we can easily extend our definition to a symmetric bilinear form~$\bra\ \,,\ \ket:\Sym^*V\times\Sym^*V \rightarrow K$. Note that then $\Sym^kV$ is in general not orthogonal to $\Sym^lV$ unless $k-l \equiv 1 \mod{2}$.
\end{remark}
We wish to investigate some properties of this construction. Let $G$ be the Gram matrix of $\left< \ ,\;\right>$, \ie $G_{ij} = \left<e_i,e_j\right>$. 
Our main result is then:
\begin{theorem} \label{maintheorem}
The determinant of the Gram matrix $\G$ of $\bra\ ,\;\ket$ is:
\begin{equation}
\det(\G)= \det(G)^{\binom{d+k}{k-1}}\,(-1)^{\binom{d+k}{k}}\theta_{d,k}
\end{equation}
where $\theta_{d,k}$ is a combinatorial factor given by:
\begin{equation}
\theta_{d,k} = \left\{
 \begin{array}{*2{l}p{5cm}}
 \displaystyle\prod_{i=1}^k i^{\binom{k-i+d}{d}d}\prod_{\substack{i=1 \\ i\ \text{odd}\\\ }}^{2k+d-1}i^{\binom{k-i+d}{d}} &\text{if }d\text{ is even}, \\
 \displaystyle\prod_{i=1}^k i^{\binom{k-i+d}{d}d}\prod_{i=1}^{k+\frac{d-1}{2}} i^{\binom{k-i+d}{d} - \binom{k-2i+d}{d}} &\text{if }d\text{ is odd}.
\end{array}
\right.
\end{equation}
\end{theorem}
See Section \ref{proofsection} for the proof. Note that for small $d$ and $k$ we have nicer formulas for $\theta_{d,k}$:
\begin{gather*}
\theta_{d,1} =1,\qquad \theta_{d,2} = 2^{d}(d+3), \\
\theta_{0,k} = (2k-1)!!, \qquad \theta_{1,k} = (k!)^{k+1}.
\end{gather*}


%We shall assume that it is non-degenerate, so $G^{-1} $ exists.
\begin{proposition} In the case $K=\R$, under the obvious isomorphism
\begin{equation*}
\Sym^* V \cong \R\!\left[x_0,\ldots,x_{d}\right]
\end{equation*}
that identifies the standard base of $Sym^kV$ with monomials of degree $k$, the bilinear form is mapped to
\begin{equation}
\bra x^\alpha, x^\beta \ket = \frac{1}{c}\int_{\R^{d+1}} x^\alpha x^\beta d\mu(x).
\end{equation}
Here the integration measure is given by $d\mu(x) = \exp\left(-\frac{1}{2}\sum_{i,j} G^{-1}_{ij}x_ix_j\right)dx$ and the normalization constant $c=\int_{\R^{n+1}} d\mu(x)$.
\end{proposition}
\begin{proof}
Since the integral is invariant under orthogonal transformations of the base space, too, we may assume that $G= \text{diag}\left(a_0,\ldots,a_d\right)$ is a diagonal matrix. Denote $m(i)$ the exponent of $x_i$ in $x^\alpha x^\beta$. Then the integral splits nicely:
$$
\bra x^\alpha, x^\beta \ket = \frac{1}{c}\prod_{i=0}^d \int_{-\infty} \infty x_i^{m(i)} e^{-\frac{1}{2}x_i^2}dx_i =
$$
%In order to increase readability of the proof, we put $d=1$, because the generalisation is evident. Definition \ref{formdef} reads then
$$ 
\bra e_0^{\otimes i}e_1^{\otimes k-i}\,,\, e_0^{\otimes j}e_1^{\otimes k-j} \ket = \prod_n=0^d
$$
\end{proof}


\section{Homogeneous Orthogonal Polynomials on the sphere}
In this section we will construct a basis for the space of homogeneous polynomials of degree $k$ in $d+1$ variables, $\R[x_0,\ldots,x_d]_k$, that is orthogonal with respect to the bilinear form given by
\begin{equation*}
 \bra f,g\ket = \int_{\R^{d+1}}f(x)g(x) d\mu(x),
\end{equation*}
where the measure is $d\mu(x) = (2\pi)^{-\frac{d+1}{2}}e^{-\frac{1}{2}\|x\|^2}dx$. In order to do this, we wish to apply the Gram-Schmidt process to the (lexicographically ordered) monomial basis $(x^\alpha)_{|\alphaÂ |=k}$. Our result is stated in Subsection \ref{hsection}. 
\begin{remark}
In view of Lemma \ref{homosphere}, we could equivalently integrate the homogeneous polynomials over the unit sphere $\S^d$. That is the reason why we call them orthogonal on the sphere.
\end{remark}
\begin{remark}
 If the homogeneity constraint was dropped, the answer to the problem would be much simpler: A basis of $ \bra\ ,\;\ket$-orthogonal polynomials is given by products $H_{\alpha_0}\!(x_0)\ldots H_{\alpha_d}\!(x_d)$ of Hermite polynomials in one variable, see also \cite[Sect.~2.3.4]{Dunkl}.
\end{remark}
\subsection{Some formulas}
We give a few basic definitions and recall some facts on elementary calculus which we will need in the sequel. The reader may also consult \cite{Folland}.
\begin{definition}
For a multi-index $\alpha=(\alpha_0,\ldots,\alpha_d)$ we define: $x^\alpha \coloneqq x_0^{\alpha_0}\ldots x_d^{\alpha_d}$. The degree is defined by $|\alpha |\coloneqq\sum\alpha_i$, the factorial is $\alpha! \coloneqq \prod \alpha_i!$. Further, we set
$\alpha'\coloneqq(\alpha_0,\ldots,\alpha_{d-1})$. We introduce the lexicographical ordering on multi-indices: $\alpha < \beta$ iff $\alpha_d < \beta_d$ or $(\alpha_d=\beta_d) \wedge (\alpha'<\beta')$.
\end{definition}
Denote $\Gamma(t)$ the gamma function. It satisfies:
\begin{align}
n!&=\Gamma(n+1),\qquad (2n-1)!!\sqrt{\pi} =2^{n}\Gamma\left(n+\tfrac{1}{2}\right), \\
\label{doublegamma}
n!&\sqrt{\pi}=2^{n}\Gamma\left(\tfrac{n}{2}+1\right)\Gamma\left(\tfrac{n+1}{2}\right) ,\\
\int_0^\infty& r^se^{-\frac{1}{2}r^2} dr = 2^{\frac{s-1}{2}}\Gamma\left(\tfrac{s+1}{2}\right).
\end{align}
Using symmetry, it follows immediately that:
\begin{align}    \label{monoint}
 \int_{\R^{d+1}}x^\alpha x^\beta & e^{-\frac{1}{2}\|x\|^2} dx = \ \ 
\displaystyle \prod_{i=0}^d \int_{-\infty}^\infty x_i^{\alpha_i+\beta_i} e^{-\frac{1}{2}x_i^2} dx_i \\
 &= \left\{
\begin{array}{*2{l}p{5cm}}
(2 \pi)^{\frac{d+1}{2}}\prod_{i=0}^d (\alpha_i+\beta_i-1)!! &\text{if all }\alpha_i+\beta_i\text{ are even}, \vspace{0.2cm} \\ 
 0 &\text{otherwise}.
\end{array}
  \right.\nonumber
\end{align}

\begin{lemma}\label{homosphere}
Let $f:\R^{n+1}\rightarrow\R$ be an integrable homogeneous function of degree $k$, that is $f(sx) = s^kf(x)$. Using polar coordinates $(r,\omega) = (\|x\|,\frac{x}{\|x\|})$, we get:
\begin{align*}
\int_{\R^{d+1}}f(x)e^{-\frac{1}{2}\|x\|^2} dx &= \int_{\S^d}\!\int_0^\infty\! f(r\omega) r^d e^{-\frac{1}{2}r^2}dr d\omega \\
&= 2^{\frac{k+d-1}{2}}\Gamma\left(\tfrac{k+d+1}{2}\right)\int_{\S^d}f(\omega)d\omega .
\end{align*}
\end{lemma}


\subsection{Generalities on orthogonal polynomials}
\begin{theorem}[Favard's theorem] \label{favard}
Let $(p_n)_n$ be a sequence of polynomials, such that $\deg p_n =n$ and the following three-term recurrence holds:
$$p_0(x) = 1,\qquad  p_{n+1}(x) = (x-c_n)p_n(x) - d_np_{n-1}(x).
$$
Then there exists a unique linear functional $\L$ such that $\L(1)=1$ and $\L(p_np_{n'})=0$ for $n\neq n'$. Moreover, for $n\geq 1$ we have: $\L(p_n^2) = d_n\L(p_{n-1}^2)$.
\end{theorem}



\subsection{A polynomial family}
\begin{definition} Let $n,\ m$ be integers with $0\leq 2n\leq m+1$, a condition that we always will assume silently. We define polynomials $\p{n}{m}$ of degree $n$:
\begin{equation}
\p{n}{m}(x) \coloneqq \sum_{\substack{l=0\\ n-l\ \text{even}}}^n \frac{n!\,(m-2n)!!\,(-1)^{\frac{n-l}{2}}}{l!\,(m-n-l)!!\,(n-l)!!}\;x^l.
\end{equation}
\end{definition}
It is straightforward to check that the following two identities hold.
\begin{lemma} \label{trigonometric}
For $n\geq 1$, we have a trigonometric differential relation:
\begin{equation}
\frac{d}{d\omega} \Big[\p{n-1}{m-2}\big(\tan(\omega)\big)\cos(\omega)^{m-1} \Big]= (n-m)\, \p{n}{m}\big(\tan(\omega)\big)\cos(\omega)^{m-1}
\end{equation} \qed
\end{lemma}
\begin{proposition} \label{threeterm} For $0\leq 2n\leq m+1$, we have a three-term recurrence:
\begin{equation}
\p{0}{m}(x) = 1,\qquad \p{1}{m}(x) = x, \qquad \p{n+1}{m}(x) = x\p{n}{m}(x) -d_n^m \p{n-1}{m}(x),
\end{equation} 
where $d_n^m\coloneqq \frac{n(m-n+1)}{(m-2n)(m-2n+2)}$.\qed
\end{proposition}
\begin{theorem} \label{pthm}We define, for $m\geq 1$, a linear functional $\L$ on the vector space of polynomials of degree less than $m$, by setting
\begin{equation}
\L: f \longmapsto \int_0^\infty\!\!\! \int_{-\infty}^\infty z^{m-1}f\left(\frac{y}{z}\right) e^{-\frac{y^2+z^2}{2}} dydz.
\end{equation}
Then the $\p{n}{m}$ form a set of orthogonal polynomials with respect to the induced bilinear form, \ie $\L(\p{k}{m}\p{n}{m})=0$ for $k\neq n$ and 
\begin{equation} \label{Lpn2}
\L(\p{n}{m}\p{n}{m}) = 2^{\frac{3}{2}m-\frac{1}{2}-2n}  \frac{n!}{(m-n)!}
\Gamma\left(\frac{m}{2}-n\right)\Gamma\left(\frac{m}{2}-n+1\right)\Gamma\left(\frac{m+1}{2}\right).
\end{equation}
\end{theorem}
\begin{proof}
Since $\p{n}{m}$ satisfy the three-term relation in Prop.~\ref{threeterm}, by Favard's theorem, there exists a unique\footnote{Despite the fact that Favard's theorem is stated in a slightly different situation, namely for an infinite family of polynomials, the functional $\L'$ is unique on the space of poly of degree less than $\frac{m-1}{2}$.} functional $\L'$ with $\L'(1)=1$, such that the $\p{n}{m}$ form an orthogonal basis with respect to the bilinear form induced by $\L'$. We claim that $\L$ is a scalar multiple of $\L'$.
Since $(\p{n}{m})_{n} $ is a basis of the space of polynomials, we must show that, for $n\geq 1$, $\L(\p{n}{m}) = \L(\p{n}{m}\p{0}{m}) =0$.
Using polar coordinates $(y,z) = (r\cos\omega,r\sin\omega)$ and Lemma \ref{trigonometric}, we get:
\begin{align*}
\L(\p{n}{m}) &= \int_0^\pi\!\!\int_0^\infty r^m\sin(\omega)^{m-1} \p{n}{m}\left(\tfrac{\cos\omega}{\sin\omega}\right)e^{-\frac{r^2}{2}}dr d\omega \\
&=\int_0^\infty r^m e^{-\frac{r^2}{2}}dr \int_{\frac{\pi}{2}}^{\frac{3\pi}{2}} (-1)^n \cos(\omega)^{m-1}\p{n}{m}\big(\tan(\omega)\big)d\omega\\
&= 2^{\frac{m-1}{2}}\Gamma\left(\tfrac{m+1}{2}\right)\Big[\tfrac{(-1)^n}{n-m}p_{n-1}^{m-2}\big(\tan(\omega)\big)\cos(\omega)^{m-1} \Big]_{\frac{\pi}{2}}^{\frac{3\pi}{2}} =0,
\end{align*}
while $\L(1) = 2^{\frac{m-1}{2}}\sqrt{\pi}\,\Gamma\!\left(\frac{m}{2}\right)=2^{\frac{3m-1}{2}}  \frac{1}{m!}
\Gamma\left(\frac{m}{2}\right)\Gamma\left(\frac{m}{2}+1\right)\Gamma\left(\frac{m+1}{2}\right)$ by (\ref{monoint}) and (\ref{doublegamma}). To verify that equation (\ref{Lpn2}) holds for $n\geq 1$, too, check that the right hand side satisfies $\L(\p{n}{m}\p{n}{m}) = d_n^m\L(\p{n-1}{m}\p{n-1}{m})$, the second information from Favard's theorem. 
\end{proof}
\begin{corollary} \label{pcor}
 $\L(x^{k}\p{n}{m}) = 0$ for $k < n$ and $\L(x^n\p{n}{m})= \L(\p{n}{m}\p{n}{m})$.
\end{corollary}
\begin{proof}
The first assertion is established by the theorem in the case $k=0$. Now the three-term recurrence from Proposition \ref{threeterm} allows us to inductively conclude that $\L(x^k\p{n}{m}) = \L(x^{k-1}\p{n+1}{m})+d_n^m\L(x^{k-1}\p{n-1}{m}) =0$. The second assertion is trivial in the case $n\leq 1$. For $n\geq 1$, the same argument as above yields now $\L(x^n\p{n}{m}) = \L(x^{n-1}\p{n+1}{m})+d_n^m\L(x^{n-1}\p{n-1}{m})=d_n^m\L(x^{n-1}\p{n-1}{m})$, so $\L(x^n\p{n}{m})$ and $\L(\p{n}{m}\p{n}{m})$ must be equal because they satisfy the same recurrence relation.
\end{proof}



\subsection{Homogeneous orthogonal polynomials} \label{hsection}
We are now ready to give the desired basis of homogeneous polynomials that are orthogonal on the sphere. Inspired by the procedure for spherical harmonics, see \cite[p.~35]{Dunkl}, we make the following
\begin{definition} \label{hdef}
For multi-indices $\alpha=(\alpha_0,\ldots,\alpha_d)$ we recursively define homogeneous polynomials $h_\alpha$ of degree $|\alpha |$ by $h_{(\alpha_0)}(x) \coloneqq x_0^{\alpha_0}$ and, for $d\geq 1$,
$$
h_\alpha(x) \coloneqq \p{\alpha_d}{2|\alpha |+d}\left(\frac{x_d}{r}\right) r^{\alpha_d}h_{\alpha'}(x'),
$$
where we have set $r=\sqrt{x_0^2 +\ldots+x_{d-1}^2}=\|x'\|$.
\end{definition}
\begin{theorem} Fix a degree $k$.
Then the $h_\alpha(x),\ |\alpha|=k$ form an orthogonal basis of $\R[x_0,\ldots,x_d]_k$ that comes from a Gram--Schmidt process applied to the monomials. More precisely, we have:
\begin{align} \label{hth1}
\bra h_\alpha ,h_\alpha \ket &= 2^{|\alpha '|+|\alpha |+d}\,
\frac{\alpha_d!\,\Gamma\!\left(|\alpha '|+\frac{d}{2}+1\right)\Gamma\!\left(|\alpha |+\frac{d+1}{2}\right)}{\sqrt{\pi}\,\left(|\alpha '|+|\alpha |+d\right)!}\bra h_{\alpha '},h_{\alpha '}\ket ,\\
\label{hth2}
\bra h_\alpha,h_\beta \ket &= 0 \quad\text{for }\alpha\neq\beta,\\
\label{hth3}
\bra x^\alpha, h_\alpha \ket &= \bra h_\alpha ,h_\alpha \ket ,\\
\label{hth4}
\bra x^\alpha,h_\beta \ket &= 0 \quad\text{for }\alpha < \beta.
\end{align}
\end{theorem}
\begin{proof}
For equation (\ref{hth1}), we use polar coordinates on $\R ^d$ to compute:
\begin{align*}
 &\int_{\R^{d+1}}\left[\p{\alpha_d}{2|\alpha|+d}\left(\frac{x_d}{r}\right) r^{\alpha_d}h_{\alpha'}(x)\right]^2 e^{-\frac{1}{2}\|x\|^2} dx \\
 = & \int_0^\infty\!\!\int_{\R} \left[\p{\alpha_d}{2|\alpha|+d}\left(\frac{x_d}{r}\right)\right]^2 r^{2|\alpha'|+2\alpha_d+d-1} e^{-\frac{r^2+x_d^2}{2} }dx_ddr\int_{\S^{d-1}}\left[h_{\alpha'}(\omega)\right]^2 d\omega \\
\myeq{(\ref{Lpn2})}& \  \frac{\alpha_d!\, 2^{2|\alpha '|+|\alpha|+\frac{3}{2}d-\frac{1}{2}} }{\left(|\alpha|+|\alpha'|+d\right)!} { \textstyle
\Gamma\!\left( |\alpha'| \!+\!\frac{d}{2}\right)\Gamma\!\left( |\alpha'|\!+\! \frac{d}{2}\!+\! 1\right) \Gamma\!\left( |\alpha| \!+\! \frac{d+1}{2}\right) }\int_{\S^{d-1}}\!\!\left[h_{\alpha'}(\omega)\right]^2 d\omega \\
\myeq{Lemma \ref{homosphere}}&\quad\quad 2^{|\alpha '|+|\alpha |+d+\frac{1}{2}}\,
\frac{\alpha_d!\;\Gamma\!\left(|\alpha '|\!+\!\frac{d}{2}\!+\!1\right)\Gamma\!\left(|\alpha |\!+\!\tfrac{d+1}{2}\right)}{\left(|\alpha '|+|\alpha |+d\right)!} \int_{\R^d} \left[h_{\alpha'}(x')\right]^2 dx'.
\end{align*}
For the proof of (\ref{hth2}), we may assume that $\alpha_d \neq \beta_d$. Then we use the calculation above to see that Thm. \ref{pthm} now implies the vanishing of the integral. Equations (\ref{hth3}) and (\ref{hth4}) follow from Corollary \ref{pcor} in the same way.
\end{proof}


\section{Proof of Theorem \ref{maintheorem}} \label{proofsection}


\section{Application in Hyperk\"ahler geometry}
Let $X$ be a compact Hyperk\"ahler manifold of complex dimension $2k$. These objects are also called Irreducible Holomorphic Symplectic manifolds. The second cohomology group $H^2(X,\Z)$ comes with an integral quadratic form, called the Beauville--Bogomolov form $q_X$, which can be computed by an integration over some cup--product power, see \cite[Subsection~2.3]{OGrady}:
\begin{equation} \label{fujiki}
\int_X \alpha ^{2k} = (2k-1)!!\,c_X q_X(\alpha)^k,\qquad \alpha\in H^2(X,\Z).
\end{equation}
This equation is referred to as the Beauville--Fujiki relation. The constant $c_X\in\Q$ is chosen such that the quadratic form $q_X$ is indivisible and $q_X(\sigma + \bar{\sigma}) > 0$ for a holomorphic two-form $\sigma$ with $\int_X\sigma\bar{\sigma} = 1$. There is an alternative description, as shown in \cite[Chap.~23]{Huybrechts}. Up to a scalar factor $\tilde{c}$, $q_X$ is equal to:
\begin{equation}\label{bb}
 \tilde{c}\,q_X(\alpha) = \frac{k}{2}\int_X \alpha^2 (\sigma\bar{\sigma})^{k-1} + (1-k)\left(\int_X\alpha\,\sigma^{n-1}\bar{\sigma}^{n}\right)\left(\int_X\alpha\,\sigma^{n}\bar{\sigma}^{n-1}\right).
\end{equation}
Now $q_X$, by polarisation, gives rise to a symmetric bilinear form $\left<\ ,\;\right>$ on $H^2(X,\Z)$, namely $2\left<\alpha,\beta\right> \coloneqq q_X(\alpha+\beta)-q_X(\alpha) -q_X(\beta)$. On the other hand, from (\ref{fujiki}) one deduces (again by polarisation, cf.~\cite[Eq.~3.2.4]{OGrady}) that:
\begin{equation}
 \int_X \alpha_1\wedge\ldots\wedge\alpha_{2k} = c_X \bra \alpha_1\ldots\alpha_k\,,\,\alpha_{k+1}\ldots\alpha_{2k}\ket,
\end{equation}
with the induced form $\bra\ ,\;\ket$ on $\Sym^kH^2(X,\Z)$, according to Definition \ref{formdef}. Since the Poincar\'e pairing $(\beta_1,\beta_2)_X \coloneqq \int_X\beta_1\wedge\beta_2$ gives $H^{2k}(X,\Z)$ the structure of an unimodular lattice, we have got a primitive imbedding of lattices:
\begin{equation}
\Big( \Sym^kH^2(X,\Z),\: c_X\!\bra\ ,\;\ket\Big) \longrightarrow \Big(H^{2k}(X,\Z),\;(\ ,\;)_X\Big).
\end{equation}
From this observation and Theorem \ref{maintheorem}, we deduce some interesting corollaries:
\begin{corollary}
Let $X$ be a compact Hyperk\"ahler manifold of complex dimension $2k$. Denote $h_2$ resp.~$d_2$ the rank and the discriminant of $H^2(X,\Z)$. Then the torsion part of the quotient
$$
\frac{H^{2k}(X,\Z)}{\Sym^kH^2(X,\Z)}
$$
contains no prime factors that are bigger than $2k+h_2-2$ and don't divide neither $c_X$ nor $d_2$. \qed
\end{corollary}
For the known examples of compact Hyperk\"ahler manifolds, we can refine this a bit, using \cite[Table~1]{OGrady}:
\begin{corollary}
 The torsion part of the quotient
$$
\frac{H^{2k}(X,\Z)}{\Sym^kH^2(X,\Z)}
$$
contains no prime factors bigger than
\begin{itemize}
\item $2k+21$, if $X$ is $S^{[k]}$, the Hilbert scheme of $k$ points on a K3 surface $S$,
\item $2k+5$, if $X$ is $K^{[[k]]}$, the generalized Kummer variety of a torus,
\item $16$, if $X$ is the 10--dimensional O'Grady manifold,
\item $6$, if $X$ is the 6--dimensional O'Grady manifold.
\end{itemize} \qed
\end{corollary}
\begin{remark}
The cases $X=S^{[2]}$ and $X=S^{[3]}$ were already studied in \cite[Prop.~6.6]{BNS} and \cite[Prop.~2.4]{Kapfer}, using explicit calculations. The case $X=S^{[2]}$ is particularly nice, because $\Sym^2H^2(S^{[2]},\Z)$ and $H^4(S^{[2]},\Z)$ have the same rank. Since the rank and the discriminant of $H^2(S^{[2]},\Z)$ are $23$ and $-2$, Theorem \ref{maintheorem} implies that the cardinality of the quotient is precisely $\sqrt{2^{24}\,2^{22}(22+3)}$.
\end{remark}



\bibliographystyle{amsplain}
\bibliography{SymBil.tex}


\end{document}

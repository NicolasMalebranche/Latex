\part{Computing Cup-Products in integral cohomology of Hilbert schemes of points on K3 surfaces}

The Hilbert schemes of $n$ points on a complex surface parametrize all zero-dimensional subschemes of length $n$. Studying their rational cohomology, Nakajima \cite{Nakajima} was able to give an explicit description of the vector space structure in terms of the action of a Heisenberg algebra.
The Hilbert schemes of points on a K3 surface are one of the few known classes of Irreducible Holomorphic Symplectic Manifolds. Lehn and Sorger \cite{LehnSorger} developed an algebraic model to describe the cohomological ring structure. On the other hand, Qin and Wang \cite{QinWang} found a base for integral cohomology in the projective case. By combining these results, we are able to compute all cup-products in the cohomology rings of Hilbert schemes of $n$ points on a projective K3 surface with integral coefficients. 
For $n=2$, this was done by Boissi\`ere, Nieper-Wi{\ss}kirchen and Sarti \cite{BNS}, who applied their results to automorphism groups of prime order. When $n$ is increasing, the ranks of the cohomology rings become very large, so we need the help of a computer. The source code is available under \url{https://github.com/s--kapfer/HilbK3}

Our goal here is to give some properties for low degrees.
Denote by $S\hilb{3}$ the Hilbert scheme of 3 points on a projective K3 surface (or a deformation equivalent space). We identify $\Sym^kH^2(S\hilb{n},\IZ)$ with its image in $H^{2k}(S\hilb{n},\IZ)$ under the cup product mapping. 
\begin{theorem}
The cup product mappings for the Hilbert scheme of 3 points on a projective K3 surface have the following cokernels:
\begin{gather}
\frac{H^4(S\hilb{3},\IZ)}{\Sym^2 H^2(S\hilb{3},\IZ)}  \cong \frac{\IZ}{3\IZ} \oplus \IZ^ {\oplus 23}\\
\frac{H^6(S\hilb{3},\IZ)}{H^2(S\hilb{3},\IZ)\smile H^4(S\hilb{3},\IZ)} \cong \left(\frac{\IZ}{3\IZ}\right)^{\oplus 23}
\end{gather}
\end{theorem}
Although the case $n=3$ is the most interesting for us, our computer program allows computations for arbitrary $n$. We give some numerical results in Section \ref{CompSection}.\vspace{5pt}

\emph{Acknowledgements.} The author thanks Samuel~Boissi\`ere and Marc~Nieper-Wi{\ss}kirchen for their supervision and many helpful comments. He also thanks Gr\'{e}goire~Menet for stimulating proposals and the Laboratoire de Math\'{e}matiques et Applications of the university of Poitiers for its hospitality. This work was partially supported by a DAAD grant.
\section{Preliminaries}
\begin{definition}
Let $n$ be a natural number. A partition of $n$ is a decreasing sequence $\lambda = (\lambda_1,\ldots,\lambda_k),\ \lambda_1\geq\ldots\geq\lambda_k>0$ of natural numbers such that $\sum_i \lambda_i =n$. Sometimes it is convenient to write $\lambda = (\ldots,2^{m_2},1^{m_1})$ with multiplicities in the exponent. No confusion should be possible since numerical exponentiation is never meant in this context. We define the weight $\|\lambda\| :=\sum m_i i =n$ and the length $|\lambda| := \sum_i m_i =k$. We also define $z_\lambda \coloneqq\prod_i i^{m_i} m_i!$. 
\end{definition}
\begin{definition} \label{SymFun}
Let $\Lambda_n := \IQ[x_1,\ldots,x_n]^{S_n}$ be the graded ring of symmetric polynomials. There are canonical projections $: \Lambda_{n+1}\rightarrow\Lambda_n$ which send $x_{n+1}$ to zero. The graded projective limit
$\Lambda:=\lim\limits_{\leftarrow}\Lambda_n$ is called the ring of symmetric functions.
Let $m_\lambda$ and $p_\lambda$ denote the monomial and the power sum symmetric functions. They are defined as follows: For a monomial $x_{i_1}^{\lambda_1}x_{i_2}^{\lambda_2}\ldots x_{i_k}^{\lambda_k}$ of total degree $n$, the (ordered) sequence of exponents $(\lambda_1,\ldots,\lambda_k)$ defines a partition $\lambda$ of $n$, which is called the shape of the monomial. Then we define $m_\lambda$ being the sum of all monomials of shape $\lambda$. For the power sums, first define $p_n := x_1^n + x_2^n + \ldots$. Then $p_\lambda := p_{\lambda_1}p_{\lambda_2}\ldots p_{\lambda_k}$.

The families $(m_\lambda)_\lambda$ and $(p_\lambda)_\lambda$ form two $\IQ$-bases of $\Lambda$, so they are linearly related by $p_\lambda = \sum_{\mu} \psi_{\lambda\mu}m_\mu$. It turns out that the base change matrix $(\psi_{\lambda\mu})$ has integral entries, but its inverse $(\psi_{\mu\lambda}^{-1})$ has not. A method to determine the $(\psi_{\lambda\mu})$ is given by Lascoux in \cite[Sect. 3.7]{Lascoux}.
\end{definition}

\begin{definition}
Let $S$ be a projective K3 surface. We fix integral bases $\One$ of $H^0(S,\IZ)$, $x$ of $H^4(S,\IZ)$ and $\alpha_1,\ldots ,\alpha_{22}$ of $H^2(S,\IZ)$. The cup product induces a symmetric bilinear form $B_{H^2}$ on $H^2(S,\IZ)$ and thus the structure of a unimodular lattice.
We may extend $B_{H^2}$ to a symmetric non-degenerate bilinear form $B$ on $H^\ast(S,\IZ)$ by setting $ B(\One,\One) = 0,\ B(\One,\alpha_i) = 0,\ B(\One,x) = 1, \ B(x,x) = 0$.
\end{definition}
By the Hirzebruch index theorem, we know that $H^2(S,\IZ)$ has signature $-16$ and, by the classification theorem for indefinite unimodular lattices, is isomorphic to $U^{\oplus 3}\oplus (-E_8)^{\oplus 2}$.
\begin{definition}\label{comult}
$B$ induces a form $B\otimes B$ on $\Sym^2H^\ast(S,\IZ)$. So the cup-product 
\begin{equation*}
\mu : \Sym ^2H^{*}(S,\IZ) \longrightarrow H^\ast(S,\IZ) 
\end{equation*}
induces an adjoint comultiplication $\Delta$ that is coassociative, given by:
\begin{equation*}
\Delta : H^\ast(S,\IZ) \longrightarrow \Sym^2H^\ast(S,\IZ),\quad \Delta = -(B\otimes B)^{-1}\mu^TB
\end{equation*}
with the property $(B\otimes B)\left(\Delta(a),b\otimes c\right)=-B\left(a,b\smile c\right)$. Note that this does not define a bialgebra structure.
The image of $\One$ under the composite map $\mu\circ\Delta$, denoted by $e=24x$ is called the Euler Class.

More generally, every linear map $f: A^{\otimes k} \rightarrow A^{\otimes m}$ induces an adjoint map $g$ in the other direction that satisfies $(-1)^mB^{\otimes m}(f(x),y)= (-1)^{k} B^{\otimes k}(x,g(y))$.
\end{definition}
We denote by $S\hilb{n}$ the Hilbert scheme of $n$ points on $S$, \ie the classifying space of all zero-dimensional closed subschemes of length $n$. $S\hilb{0}$ consists of a single point and $S\hilb{1}=S$. Fogarty \cite[Thm.~2.4]{Fogarty} proved that the Hilbert scheme is a smooth variety.
A theorem by Nakajima \cite{Nakajima} gives an explicit description of the vector space structure of $H^\ast(S\hilb{n},\IQ)$ in terms of creation operators
$$
\kq_l(\beta) :  H^\ast(S\hilb{n},\IQ) \longrightarrow  H^{\ast+k+2(l-1)}(S\hilb{n+l},\IQ)
,$$ 
where $\beta\in H^k(S,\IQ)$, acting on the direct sum 
$\mathbb{H}:=\bigoplus_n H^\ast(S\hilb{n},\IQ)$. The operators $\kq_l(\beta)$ are linear and commute with each other. The vacuum vector $\vac$ is defined as the generator of $H^0(S\hilb{0},\IQ)\cong\IQ$. The images of $\vac$ under the polynomial algebra generated by the creation operators span $\mathbb{H}$ as a vector space. 
Following \cite{QinWang}, we abbreviate $\kq_{l_1}(\beta)\ldots\kq_{l_k}(\beta)=:\kq_\lambda(\beta)$, where the partition $\lambda$ is composed by the $l_i$. 

An integral basis for $H^\ast(S\hilb{n},\IZ)$ in terms of Nakajima's operators was given by Qin--Wang:
\begin{theorem} \label{QinWangTheorem}\cite[Thm. 5.4.]{QinWang} Let $\km_{\nu,\alpha} := \sum_\rho \psi_{\nu\rho}^{-1}\,\kq_{\rho}(\alpha)$, with coefficients $ \psi_{\nu\rho}^{-1}$ as in Definition \ref{SymFun}. The classes
$$ \frac{1}{z_\lambda} \kq_\lambda(1)\kq_\mu(x)\km_{\nu^1,\alpha_1}\ldots\km_{\nu^{22},\alpha_{22}}\vac,\quad \|\lambda\| +\|\mu\| + \sum_{i=1}^{22}\|\nu^i\| = n
$$ 
form an integral basis for $H^\ast(S\hilb{n},\IZ)$. Here,
$\lambda,\; \mu,\; \nu^i$ are partitions.
\end{theorem}
\begin{notation}\label{notation}
To enumerate the basis of $H^\ast(S\hilb{n},\IZ)$, we introduce the following abbreviation:
$$ \boldsymbol\alpha^{\boldsymbol\lambda} :=
\One^{\lambda^0} \alpha_1^{\lambda^1}\ldots\alpha_{22}^{\lambda^{22}}x^{\lambda^{23}} :=
\frac{1}{z_{\widetilde{\lambda^0}} }
\kq_{\widetilde{\lambda^0}}(\One)\kq_{\lambda^{23}}(x)\km_{\lambda^1,\alpha_1}\ldots\km_{\lambda^{22},\alpha_{22}}\vac
$$
where the partition $\widetilde{\lambda^0}$ is built from $\lambda^0$ by appending sufficiently many ones, such that $\left\|\widetilde{\lambda^0}\right\| +\sum_{i\geq 1}\left\|\lambda^i\right\| = n $. If $\sum_{i\geq 0}\left\|\lambda^i\right\| > n, $ we put $\boldsymbol\alpha^{\boldsymbol\lambda}=0$. Thus we can interpret $\boldsymbol\alpha^{\boldsymbol\lambda}$ as an element of $H^\ast(S\hilb{n},\IZ)$ for arbitrary $n$. We say that the symbol $\boldsymbol\alpha^{\boldsymbol\lambda}$ is reduced, if $\lambda^0$ contains no ones. We define also $\left\|\boldsymbol\lambda\right\| := \sum_{i\geq 0}\left\|\lambda^i\right\|$. 
\end{notation}
\begin{lemma}\label{degBound}
Let $\boldsymbol\alpha^{\boldsymbol\lambda}$ represent a class of cohomological degree $2k$. If $\boldsymbol\alpha^{\boldsymbol\lambda}$ is reduced, then $\frac{k}{2}\leq\left\|\boldsymbol{\lambda}\right\| \leq 2k$.
\begin{proof} This is a simple combinatorial observation. We give the two extremal cases.
The lowest ratio between $\left\|\boldsymbol{\lambda}\right\|$ and $\deg \boldsymbol\alpha^{\boldsymbol\lambda}$ is achieved by the classes $x^{(1^m)}$, where the degree is $4m$ and the weight of $\boldsymbol{\lambda}$ is $m$. The highest ratio is achieved by the classes $1^{(2^m)}$, where both degree and weight equal $2m$. So $\frac{1}{4}\leq\frac{\left\|\boldsymbol{\lambda}\right\|}{\deg \boldsymbol\alpha^{\boldsymbol\lambda}}\leq 1$.
\end{proof}
\end{lemma}
The ring structure of $H^\ast(S\hilb{n}, \IQ)$ has been studied by Lehn and Sorger in \cite{LehnSorger}, where an explicit algebraic model is constructed, which we recall briefly:
\begin{definition} \label{model}\cite[Sect. 2]{LehnSorger}
Let $\pi$ be a permutation of $n$ letters, written as a product of disjoint cycles. To each cycle we may associate an element of $A:=H^\ast(S,\IQ)$. This defines an element in $A^{\otimes m}$, $m$ being the number of cycles. For example, a term like $(1\,2\,3)_{\alpha_1}(4\,5)_{\alpha_2}$ may describe a permutation consisting of two cycles with associated classes $\alpha_1,\alpha_2\in A$. We interpret the cycles as the orbits of the subgroup $\left<\pi\right>\subset S_n$ generated by $\pi$. We denote the set of orbits by $\left<\pi\right>\backslash[n]$. Thus we construct a vector space $A\{S_n\}:=\bigoplus_{\pi\in S_n} A^{\otimes\left<\pi\right>\backslash[n]}$. 

To define a ring structure, take two permutations $\pi,\,\tau \in S_n$ and the subgroup $\left< \pi,\tau\right>$ generated by them. The natural map of orbit spaces
$
p_\pi:\left<\pi\right>\backslash[n] \rightarrow \left<\pi,\tau\right>\backslash[n]
$
induces a map $f^{\pi,\left<\pi,\tau\right>} : A^{\otimes\left<\pi\right>\backslash[n]} \rightarrow A^{\otimes\left<\pi,\tau\right>\backslash[n]}$, which multiplies the factors of an elementary tensor if the corresponding orbits are glued together.
Denote $f_{\left<\pi,\tau\right>,\pi} $ the adjoint to this map in the sense of Definition \ref{comult}. Then the map
\begin{gather*}
m_{\pi,\tau} : A^{\otimes\left<\pi\right>\backslash[n]} \otimes A^{\otimes\left<\tau\right>\backslash[n]} \longrightarrow A^{\otimes\left<\pi\tau\right>\backslash[n]} ,  \\
a\otimes b \longmapsto  f_{\left<\pi,\tau\right>,\pi\tau} (f^{\pi,\left<\pi,\tau\right>} (a)\cdot f^{\tau,\left<\pi,\tau\right>}(b)\cdot  e^{g(\pi,\tau)} ) 
\end{gather*}
defines a multiplication on $A\{S_n\}$. Here the dot means the cup product on each tensor factor and $e^{g(\pi,\tau)} \in A^{\otimes\left<\pi,\tau\right>\backslash[n]}$ is an elementary tensor that is composed by powers of the Euler class $e$: for each orbit $B \in  {\otimes\left<\pi,\tau\right>\backslash[n]}$ the exponent $g(\pi,\tau)(B)$ (so-called "graph defect", see \cite[2.6]{LehnSorger}) is given by:
$$
g(\pi,\tau)(B) = \frac{1}{2}\left( |B| +2 - |p_\pi^{-1}(\{B\})|- |p_\tau^{-1}(\{B\})| - |p_{\pi\tau}^{-1}(\{B\})|  \right).
$$

\end{definition}
The symmetric group $S_n$ acts on $A\{S_n\}$ by conjugation, permuting the direct summands: conjugation by $\sigma\in S_n$ maps $A^{\otimes\left<\pi\right>\backslash[n]}$ to $A^{\otimes\left<\sigma\pi\sigma^{{-}1}\right>\backslash[n]}$.
This action preserves the ring structure. Therefore the space of invariants $A\hilb{n} := \left(A\{S_n\} \right)^{S_n}$ becomes a subring. The main theorem of \cite{LehnSorger} can now be stated:
\begin{theorem} \label{LSThm}\cite[Thm. 3.2.]{LehnSorger}
The following map is an isomorphism of rings:
\begin{align*}
H^\ast(S\hilb{n},\IQ) & \longrightarrow A\hilb{n} \\
\kq_{n_1}(\beta_1)\ldots \kq_{n_k}(\beta_k) \vac &\longmapsto \sum_{\sigma\in S_n} \sigma a \sigma^{{-}1} 
\end{align*}
with $\sum_i n_i=n$ and $a =(1\,2\ldots n_1)_{\beta_1}(n_1\! +\! 1\ldots n_1\!+\! n_2)_{\beta_2}\cdots (n\!-\!n_k \ldots n)_{\beta_k}\in A\{S_n\}$.
\end{theorem}

Since $H^\text{odd}(S\hilb{n},\IZ) = 0$ and $H^\text{even}(S\hilb{n},\IZ)$ is torsion-free by \cite{Markman}, we can apply these results to $H^\ast(S\hilb{n}, \IZ)$ to determine the multiplicative structure of cohomology with integer coefficients. It turns out, that it is somehow independent of $n$. More precisely, we have the following stability theorem, by Li, Qin and Wang:
\begin{theorem} \label{stability}\emph{(Derived from \cite[Thm.~2.1]{QinWang}).}
Let $Q_1,\ldots,Q_s$ be products of creation operators, \ie $Q_i = \prod_j \kq_{\lambda_{i,j}}(\beta_{i,j}) $ for some partitions $\lambda_{i,j}$ and classes $\beta_{i,j}\in H^\ast(S,\IZ)$. Set $n_i := \sum_j \left\|\lambda_{i,j}\right\|$.
Then the cup product 
$ \prod_{i=1}^s \left(\frac{1}{(n-n_i)!} \kq_{1^{n-n_i}}(1) \,Q_i \,\vac \right)$ equals a finite linear combination of classes of the form $\frac{1}{(n-m)!}\kq_{1^{n-m}}(1)\prod_j \kq_{\mu_{j}}(\gamma_{j})\vac$, with $\gamma\in H^\ast(S,\IZ)$, $m=\sum_j\left\|\mu_j\right\|$, whose coefficients are independent of $n$. We have the upper bound $m\leq\sum_i n_i$. Moreover, $m=\sum_i n_i$ if and only if the corresponding class is $\frac{1}{(n-m)!}\kq_{1^{n-m}}(1)Q_1Q_2\ldots Q_s\vac$ with coefficient $1$.
\end{theorem}
\begin{corollary} \label{stabCor} Let $\boldsymbol{\alpha}^{\boldsymbol{\lambda}},\boldsymbol{\alpha}^{\boldsymbol{\mu}},\boldsymbol{\alpha}^{\boldsymbol{\nu}}$ be reduced. Assume $n\geq\left\|\boldsymbol\lambda\right\|,\left\|\boldsymbol\mu\right\| $. Then the coefficients $c^{\boldsymbol{\lambda\mu}}_{\boldsymbol{\nu}}$ of the cup product in $H^\ast(S\hilb{n},\IZ)$
$$\boldsymbol{\alpha}^{\boldsymbol{\lambda}} \smile
\boldsymbol{\alpha}^{\boldsymbol{\mu}}
= \sum_{\boldsymbol{\nu}} c^{\boldsymbol{\lambda\mu}}_{\boldsymbol{\nu}} \boldsymbol{\alpha}^{\boldsymbol{\nu}}
$$  
are polynomials in $n$ of degree at most $ \left\|\boldsymbol\lambda\right\|+\left\|\boldsymbol\mu\right\|-\left\|\boldsymbol\nu\right\|$.
\end{corollary}
\begin{proof} Set $Q_{\boldsymbol{\lambda}}:=  \kq_{\lambda^0}(1)\kq_{\lambda^{23}}(x)\prod_{1\leq j\leq 22}\kq_{\lambda^j}(\alpha_j)$ and $n_{\boldsymbol\lambda}:=\left\|\boldsymbol\lambda\right\|$. Then we have:
$\boldsymbol{\alpha}^{\boldsymbol{\lambda}} = \frac{1}{(n-n_{\boldsymbol\lambda})!\,z_{\lambda^0}}\kq_{1^{n-n_{\boldsymbol\lambda}}}(1)Q_{\boldsymbol\lambda}\vac$ and $
\boldsymbol{\alpha}^{\boldsymbol{\mu}}=\frac{1}{(n-n_{\boldsymbol\mu})!\,z_{\mu^0}}\kq_{1^{n-n_{\boldsymbol\mu}}}(1)Q_{\boldsymbol\mu}\vac $. 
Thus the coefficient $c^{\boldsymbol{\lambda\mu}}_{\boldsymbol{\nu}}$ in the product expansion is a constant, which depends on $ \left\|\boldsymbol\lambda\right\|$, $\left\|\boldsymbol\mu\right\|$, $\left\|\boldsymbol\nu\right\|$, but not on $n$, multiplied with $\frac{(n-n_{\boldsymbol\nu})!}{(n-m)!}$ for a certain $m\leq n_{\boldsymbol\lambda}+n_{\boldsymbol\mu}$. 
This is a polynomial of degree $m-n_{\boldsymbol\nu}\leq n_{\boldsymbol\lambda}+n_{\boldsymbol\mu}-n_{\boldsymbol\nu} =\left\|\boldsymbol\lambda\right\|+\left\|\boldsymbol\mu\right\|-\left\|\boldsymbol\nu\right\| $.
\end{proof}
\begin{remark}
If $n<\left\|\boldsymbol\lambda\right\|$ or $n<\left\|\boldsymbol\mu\right\| $, one has $\boldsymbol{\alpha}^{\boldsymbol{\lambda}}=0$, resp.~$\boldsymbol{\alpha}^{\boldsymbol{\mu}}=0$. But it is still possible that $\boldsymbol{\alpha}^{\boldsymbol{\nu}}\neq 0$ in $H^*(S\hilb{n})$. It seems that in this case the polynomial $ c^{\boldsymbol{\lambda\mu}}_{\boldsymbol{\nu}}$ always becomes zero when evaluated at $n$. So the $ c^{\boldsymbol{\lambda\mu}}_{\boldsymbol{\nu}}$ seem to be universal in the sense that the above corollary holds true even without the condition $n\geq\left\|\boldsymbol\lambda\right\|,\left\|\boldsymbol\mu\right\| $.
\end{remark}
\begin{example}\label{example} Here are some explicit examples for illustration. See \ref{exampleSource} for how to compute them. 
\begin{enumerate} \item $
\One^{(2,2)}\smile \alpha_i^{(2)} = -2\cdot \One^{(2)}\alpha_i^{(1)}x^{(1)} + \One^{(2,2)}\alpha_i^{(2)} + 2\cdot\One^{(2)}\alpha_i^{(3)} +\alpha_i^{(4)} $ for $i\in\{1..22\}$.
\item Let $i,j\in\{1\ldots 22\}$. 
If $i \neq j$, then $\alpha_i^{(2)}\smile\alpha_j^{(1)} = \alpha_i^{(2)}\alpha_j^{(1)} + 2B(\alpha_i,\alpha_j)\cdot x^{(1)}$. 
Otherwise, $\alpha_i^{(2)}\smile\alpha_i^{(1)} = \alpha_i^{(3)}+ \alpha_i^{(2,1)} + 2B(\alpha_i,\alpha_i)\cdot x^{(1)}$.
\item Set $\boldsymbol{\alpha}^{\boldsymbol{\lambda}} = \One^{(2)}$ and $\boldsymbol{\alpha}^{\boldsymbol{\nu}}=x^{(1)}$. Then $c^{\boldsymbol{\lambda\lambda}}_{\boldsymbol{\nu}} = -(n-1)$.
\item Set $\boldsymbol{\alpha}^{\boldsymbol{\lambda}} = \One^{(2,2)}$ and $\boldsymbol{\alpha}^{\boldsymbol{\nu}}=x^{(1,1)}$. Then $c^{\boldsymbol{\lambda\lambda}}_{\boldsymbol{\nu}} =\frac{(n-3)(n-2)}{2}$.
\end{enumerate}
\end{example}
\begin{example} \label{oddWitness} Let $i,j$ be indices, such that $B(\alpha_i,\alpha_j)=1,\ B(\alpha_i,\alpha_i)=0=B(\alpha_j,\alpha_j)$ and let $k\geq 0$. Set $\boldsymbol{\alpha}^{\boldsymbol{\lambda}} = \alpha_i^{(1)}\alpha_j^{(1)}x^{(1^k)}$ 
and $\boldsymbol{\alpha}^{\boldsymbol{\nu}}= x^{(1^{2k+2})}$. Then $c^{\boldsymbol{\lambda\lambda}}_{\boldsymbol{\nu}} =1$.
\end{example}
\begin{proof}
It is not hard to see from the definition, that for $\beta_j,\;\gamma_j\in H^*(S)$:
$$
\kq_1(\beta_1)\ldots\kq_1(\beta_n)\vac \smile\kq_1(\gamma_1)\ldots\kq_1(\gamma_n)\vac = \sum_{\sigma \in S_n} \kq_1(\beta_1\cdot\gamma_{\sigma(1)})\ldots\kq_1(\beta_n\cdot\gamma_{\sigma(n)})\vac.
$$ 
A combinatorial investigation yields now:
$$
\left(\kq_1(\alpha_i)\kq_1(\alpha_j)\kq_1(x)^k\kq_1(1)^{k+m}\vac \right)^2 = \frac{(k+m)!^2}{m!} \kq_1(x)^{2k+2}\kq_1(1)^m\vac + \text{other terms}.
$$
Looking at \ref{notation}, the result follows.
\end{proof}
\begin{theorem}\label{freeness}
The quotient
$$
 \frac{H^{2k}(S\hilb{n},\IZ)}{\Sym^k H^{2}(S\hilb{n},\IZ)}
$$
is a free $\IZ$-module for $n\geq k+2$.
\end{theorem}
\begin{proof}
The idea of the proof is to modify the basis of $H^{2k}(S\hilb{n},\IZ)$, given in Theorem~\ref{QinWangTheorem}, in a way that $\Sym^k H^{2}(S\hilb{n},\IZ)$ splits as a direct summand. 

Given a free $\IZ$-module $M$ with basis $(b_i)_{i=1\ldots m}$ and a vector $v = a_1b_1 + \ldots + a_mb_m$. Then there is another basis of $M$ which contains $v$, iff $\gcd\{a_1,\ldots,a_m\} = 1$. More generally, given a set of vectors $(v_i)_{i=1\ldots r}$, $v_i=a_{i1}b_1+\ldots+a_{im}b_m$, we can complete it to a basis of $M$, iff the $r\times r$-minors of the matrix $(a_{ij})_{ij}$ share no common divisor. We want to show that the canonical basis of $\Sym^k H^{2}(S\hilb{n},\IZ)$ is such a set.

A basis of $ H^{2}(S\hilb{n},\IZ)$ is given by the classes $\alpha_i^{(1)}=\frac{1}{(n-1)!}\kq_{1^{n-1}}(1)\kq_1(\alpha_i)\vac$, $i=1,\ldots ,22$ and $1^{(2)} =\frac{1}{2(n-2)!}\kq_{(2,1^{n-2})}(1)\vac$.
A power of $\alpha_i^{(1)}$ looks like (Thm.~\ref{stability}):
\begin{align*}
\left(\alpha_i^{(1)}\right)^k & =\frac{1}{(n-k)!}\kq_{1^{n-k}}(1)\kq_{1^k}(\alpha_i)\vac + \text{other terms containing } \kq_\lambda(x).
\end{align*}
Now, by the definition of $\psi_{\lambda\mu}$, $\kq_{1^k}(\alpha_i) = \km_{(k),\alpha_i} + \ldots + k! \cdot\km_{(1^k),\alpha_i}$, so
\begin{equation}
\left(\alpha_i^{(1)}\right)^k  = \alpha_i^{(k)} + \text{other terms}.
\end{equation}
Next, we determine the coefficients of $1^{(k+1)}$ and $1^{(k,2)}$ in the expansion of $\left(1^{(2)}\right)^k$. Considering Definition \ref{model}, we observe that here the graph defect is zero and the adjoint map is trivial, so the problem reduces to combinatorics of the symmetric group: the coefficient of $1^{(k+1)}$ is the number of ways to write a $(k+1)$-cycle as a product of $k$ transpositions. A result of D\'enes \cite{Denes} states that this is $(k\!+\!1)^{k-1}$. For the $1^{(k,2)}$-coefficient, we have to choose one transposition, and write a $k$-cyle as a product of the remaining $k-1$ transpositions. The number of possibilities is therefore $k\cdot k^{k-2} = k^{k-1}$. So
\begin{equation}
\left(1^{(2)}\right)^k = (k\!+\! 1)^{k-1} \cdot 1^{(k+1)} \;+\; k^{k-1}\cdot 1^{(k,2)} \;+\; \text{other terms}.
\end{equation}
Note that these two coefficients are coprime. 
Putting the two cases together, one gets for a general element of $\Sym^kH^2(S\hilb{n},\IZ)$, $k=k_0+\ldots+k_{22}$:
\begin{align*}
\left(1^{(2)}\right)^{k_0}\prod_{i=1}^{22}\left(\alpha_i^{(1)}\right)^{k_i} &=  (k_0\!+\! 1)^{k_0-1} \cdot 1^{(k_0+1)}\alpha_1^{(k_1)}\ldots \alpha_{22}^{(k_{22})} \\
&+k_0^{k_0-1}\cdot 1^{(k_0,2)}\alpha_1^{(k_1)}\ldots \alpha_{22}^{(k_{22})} +\text{other terms}.
\end{align*}
One checks, that this is the only element of $\Sym^kH^2(S\hilb{n},\IZ)$ having a nonzero coefficient at $1^{(k_0+1)}\alpha_1^{(k_1)}\ldots \alpha_{22}^{(k_{22})}$ and $1^{(k_0,2)}\alpha_1^{(k_1)}\ldots \alpha_{22}^{(k_{22})}$. Now it is easy to show the existence of a complementary basis.
\end{proof}



\section{Computational results} \label{CompSection}
We now give some results in low degrees, obtained by computing multiplication matrices with respect to the integral basis of $H^*(S\hilb{n},\IZ)$. To get their cokernels, one has to reduce them to Smith normal form. Both results have been obtained using a computer.
\begin{remark}
Denote $h^k(S\hilb{n})$ the rank of $H^k(S\hilb{n},\IZ)$. We have:
\begin{itemize}
\item $h^2(S\hilb{n}) = 23 $ for $n\geq 2$.
\item $h^4(S\hilb{n}) = 276,\; 299,\; 300$ for $n=2,3, \geq 4$ resp.
\item $h^6(S\hilb{n}) = 23,\; 2554,\; 2852,\; 2875,\; 2876$ for $n=2,3,4,5,\geq6$ resp.
\end{itemize}
\end{remark}
The algebra generated by classes of degree 2 is an interesting object to study. For cohomology with complex coefficients, Verbitsky has proven in \cite{Verbitsky} that the cup product mapping from $\Sym^k H^2(S\hilb{n},\IC)$ to $H^{2k}(S\hilb{n},\IC)$ is injective for $k\leq n$. Since there is no torsion, one concludes that this also holds for integral coefficients.
\begin{proposition} We identify $\Sym^2H^2(S\hilb{n},\IZ)$ with its image in $H^4(S\hilb{n},\IZ)$ under the cup product mapping. Then: 
\setcounter{equation}{0} 
\begin{align}
\frac{H^4(S\hilb{2},\IZ)}{\Sym^2 H^2(S\hilb{2},\IZ)} & \cong \left(\frac{\IZ}{2\IZ}\right)^{\oplus 23} \oplus \frac{\IZ}{5\IZ},\\
\label{sym23}
\frac{H^4(S\hilb{3},\IZ)}{\Sym^2 H^2(S\hilb{3},\IZ)} & \cong \frac{\IZ}{3\IZ} \oplus \IZ^ {\oplus 23}, \\
\frac{H^4(S\hilb{n},\IZ)}{\Sym^2 H^2(S\hilb{n},\IZ)} & \cong  \IZ^ {\oplus 24}, \quad \text{for }n\geq 4.
\end{align}
The 3-torsion part in (\ref{sym23}) is generated by the integral class $1^{(3)}$.
\end{proposition}
\begin{remark}
The torsion in the case $n=2$ was also computed by Boissi\`{e}re, Nieper-Wi\ss kirchen and Sarti, \cite[Prop. 3]{BNS} using similar techniques.
For all the author knows, the result for $n=3$ is new.
The freeness result for $n\geq 4$ was already proven by Markman, \cite[Thm. 1.10]{Markman2}, using a completely different method. 
\end{remark}
\begin{proposition} For triple products of $H^2(S\hilb{n},\IZ)$, we have:
$$
\frac{H^6(S\hilb{2},\IZ)}{\Sym^3 H^2(S\hilb{2},\IZ)} \cong 
\frac{\IZ}{2\IZ}.
$$
The quotient is generated by the integral class $x^{(2)}$. Moreover,
$$
\frac{H^6(S\hilb{3},\IZ)}{\Sym^3 H^2(S\hilb{3},\IZ)} \cong  \left(\frac{\IZ}{2\IZ}\right)^{\oplus 230}\oplus \left(\frac{\IZ}{36\IZ}\right)^{\oplus 22}\oplus \frac{\IZ}{72\IZ} \oplus \IZ^{\oplus 254},
$$
$$
\frac{H^6(S\hilb{4},\IZ)}{\Sym^3 H^2(S\hilb{4},\IZ)} \cong  \frac{\IZ}{2\IZ} \oplus \IZ^{\oplus 552}.
$$
For $n\geq 5$, the quotient is free by Theorem \ref{freeness}.
\end{proposition}
We study now cup products between classes of degree 2 and 4. The case of $S\hilb{3}$ is of particular interest.
\begin{proposition} \label{p24}The cup product mapping $ : H^2(S\hilb{n},\IZ)\otimes H^4(S\hilb{n},\IZ) \rightarrow H^6(S\hilb{n},\IZ) $ is neither injective (unless $n=0$) nor surjective (unless $n\leq 2$). We have:
\setcounter{equation}{0} 
\begin{align} 
\frac{H^6(S\hilb{3},\IZ)}{H^2(S\hilb{3},\IZ)\smile H^4(S\hilb{3},\IZ)} &\cong \left(\frac{\IZ}{3\IZ}\right)^{\oplus 22} \oplus \frac{\IZ}{3\IZ},
\\
\frac{H^6(S\hilb{4},\IZ)}{H^2(S\hilb{4},\IZ)\smile H^4(S\hilb{4},\IZ)} &\cong  \left(\frac{\IZ}{6\IZ}\right)^{\oplus 22}\oplus\frac{\IZ}{108\IZ} \oplus\frac{\IZ}{2\IZ} ,
\\
\frac{H^6(S\hilb{5},\IZ)}{H^2(S\hilb{5},\IZ)\smile H^4(S\hilb{5},\IZ)} &\cong 
 \IZ^{\oplus 22} \oplus \IZ,
\\
\frac{H^6(S\hilb{n},\IZ)}{H^2(S\hilb{n},\IZ)\smile H^4(S\hilb{n},\IZ)} &\cong 
 \IZ^{\oplus 22} \oplus \IZ\oplus\IZ, \ n\geq 6.
\end{align}
In each case, the first 22 factors of the quotient are generated by the integral classes 
 $$
\alpha_i^{(1,1,1)} -3\cdot \alpha_i^{(2,1)} + 3\cdot \alpha_i^{(3)}+ 3 \cdot \One^{(2)}\alpha_i^{(1,1)} -6\cdot \One^{(2)}\alpha_i^{(2)}+6\cdot \One^{(2,2)}\alpha_i^{(1)}-3\cdot \One^{(3)}\alpha_i^{(1)},
$$ 
for $ i=1\ldots 22$. Now define an integral class
\begin{align*}
K:=&\;\sum_{i\neq j} B(\alpha_i,\alpha_j)\left[\alpha_i^{(1,1)}\alpha_j^{(1)} - 2\cdot\alpha_i^{(2)}\alpha_j^{(1)}+\frac{3}{2}\cdot \One^{(2)}\alpha_i^{(1)}\alpha_j^{(1)} \right] +\\
+&\;\sum_{i}B(\alpha_i,\alpha_i)\left[\alpha_i^{(1,1,1)} - 2\cdot\alpha_i^{(2,1)} + \frac{3}{2}\cdot \One^{(2)}\alpha_i^{(1,1)} \right]+  x^{(2)}-\One^{(2)}x^{(1)}.
\end{align*} 
In the case $n=3$, the last factor of the quotient is generated by $K$. 
\\In the case $n=4$, the class $ \One^{(4)}$ generates the 2-torsion factor and $K-38\cdot\One^{(4)}$ generates the 108-torsion factor.
\\In the case $n=5$, the last factor of the quotient is generated by $K - 16\cdot \One^{(4)} + 21\cdot \One^{(3,2)}$.\\
If $n\geq 6$, the two last factor of the quotient are generated over the rationals by $K +\frac{4}{3}(45-n)\One^{(2,2,2)} - (48-n)\One^{(3,2)}$ and $K+\frac{1}{2}(40-n)\One^{(2,2,2)}- \frac{1}{4}(48-n)\One^{(4)}$. Over $\IZ$, one has to take appropriate multiples depending on $n$, such that the coefficients become integral numbers.
\end{proposition}
\begin{proof} The last assertion for arbitrary $n$ follows from Corollary \ref{stabCor}. First observe that for $\boldsymbol{\alpha}^{\boldsymbol{\lambda}}\!\in\! H^2,\  \boldsymbol{\alpha}^{\boldsymbol{\mu}}\!\in\! H^4,\  \boldsymbol{\alpha}^{\boldsymbol{\nu}}\!\in\! H^6 $, we have $\left\| \boldsymbol\lambda\right\| \leq 2$, $\left\| \boldsymbol\mu\right\| \leq 4$ and $\left\| \boldsymbol\nu\right\| \geq 2,$ according to Lemma \ref{degBound}.
The coefficients of the cup product matrix are thus polynomials of degree at most $2+4-2 =4$ and it suffices to compute only a finite number of instances for $n$. It turns out that the maximal degree is $1$ and the cokernel of the multiplication map is given as stated.
\end{proof}

In what follows, we compare some well-known facts about Hilbert schemes of points on K3 surfaces with our numerical calculations. This means, we have some tests that may justify the correctness of our computer program.
We state now computational results for the middle cohomology group. Since $S\hilb{n}$ is a projective variety of complex dimension $2n$, Poincar\'{e} duality gives $H^{2n}(S\hilb{n},\IZ)$ the structure of a unimodular lattice.  
\begin{proposition} Let $L$ denote the unimodular lattice $H^{2n}(S\hilb{n},\IZ)$. We have:
\begin{enumerate}
\item For $n=2$, $L$ is an odd lattice of rank $276$ and signature $156$.
\item For $n=3$, $L$ is an even lattice of rank $2554$ and signature $-1152$.
\item For $n=4$, $L$ is an odd lattice of rank $19298$ and signature $7082$.
\end{enumerate}
For $n$ even, $L$ is always odd. 
\end{proposition} 
\begin{proof}The numerical results come from an explicit calculation. For $n$ even, we always have the norm-1-vector given by Example \ref{oddWitness}, so $L$ is odd. To obtain the signature, we could equivalently use Hirzebruch's signature theorem and compute the L-genus of $S\hilb{n}$. For the signature, we need nothing but the Pontryagin numbers, which can be derived from the Chern numbers of $S\hilb{n}$. These in turn are known by Ellingsrud, G\"ottsche and Lehn, \cite[Rem. 5.5]{EGL}. 
\end{proof}
Another test is to compute the lattice structure of $H^2(S\hilb{2},\IZ)$, with bilinear form given by $(a,b)\longmapsto \int \left(a\smile b\smile \One^{(2)}\smile \One^{(2)}\right)$. The signature of this lattice is $17$, as shown by Boissi\`ere, Nieper-Wi{\ss}kirchen and Sarti \cite[Lemma 6.9]{BNS}.


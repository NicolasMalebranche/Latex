\section{Generalized Kummer varieties and the morphism to the Hilbert scheme}

\begin{definition}
Let $A$ be a complex projective torus of dimension $2$ and $A\hilb{n}$, $n\geq 1$, the corresponding Hilbert scheme of points. Denote $\Sigma : A\hilb{n} \rightarrow A$ the summation morphism, a smooth submersion that factorizes via the Hilbert--Chow morphism $: A\hilb{n}\stackrel{\rho}{\rightarrow}\Sym^n(A)\stackrel{\sigma}{\rightarrow} A$. Then the generalized Kummer variety $\kum{A}{n-1}$ is defined as the fiber over $0$:
\begin{equation}\label{square}
\begin{CD}
\kum{A}{n-1} @>\theta >> A\hilb{n}\\
@VVV @VV\Sigma V\\
\{0\} @> >> A
\end{CD}
\end{equation}
\end{definition}
\begin{theorem} \cite[Theorem 2]{Spanier}\label{torsion}
The cohomology of the generalized Kummer, $H^*(\kum{A}{n-1},\Z)$, is torsion free. 
\end{theorem}
Our first objective is to collect some information about this pullback diagram. 
Recall Notation \ref{TorusClasses}.

\begin{proposition}
Let $\alpha_i := \frac{1}{(n-1)!}\kq_{1}(1)^{n-1}\kq_1(a_i)\vac = \G_0(a_i)1$. The class of the Poincar\'e dual of $\kum{A}{n-1}$ in $H^4(A\hilb{n},\Z)$ is given by
$$
%\prod_{i=1}^4 \left(\tfrac{1}{2}\pone(1)^2\pone(\alpha_i)\vac\right).
[\kum{A}{n-1}]=\alpha_1\cdot\alpha_2\cdot\alpha_3\cdot\alpha_4.
$$ 
\end{proposition}
\begin{proof}
Since the generalized Kummer variety is the fiber over a point, its Poincar\'e dual must be the pullback of $x\in H^4(A)$ under $\Sigma$. But $\Sigma^* (x) = \Sigma^*(a_1)\cdot \Sigma^*(a_2)\cdot \Sigma^*(a_3)\cdot \Sigma^*(a_4)$, so we have to verify that $\Sigma^* (a_i) = \alpha_i$. To do this, we want to use the decomposition $\Sigma = \sigma\rho$.
The pullback along $\sigma$ of a class $a\in H^1(A,\Q)$ on $H^1(\Sym^n(A),\Q)$ 
%$\cong H^1(A^n,\Q)^{\mathfrak{S}_n}$ 
is given by $a\otimes 1\otimes \cdots\otimes 1 + \ldots + 1\otimes \cdots\otimes 1\otimes a$. It follows from (\ref{q1primitive}) that $\Sigma^* (a_i) = \frac{1}{(n-1)!}\kq_{1}(1)^{n-1}\kq_1(a_i)\vac $.
\end{proof}
The morphism $\theta$ induces a homomorphism of graded rings
\begin{equation}
\theta^* :H^*(A\hilb{n})\longrightarrow H^*(\kum{A}{n-1})
\end{equation}
and on the image of $\theta^*$, the integral over $\kum{A}{n-1}$ can be written as follows:
\begin{equation}
\int\limits_{\kum{A}{n-1}}\theta^*(\alpha)\; =\; \int\limits_{A\hilb{n}} [\kum{A}{n-1}]\cdot\alpha .
\end{equation}
\begin{lemma}\label{IntegralityCheck}
Let $\alpha\in H^*(A\hilb{n},\Q)$ be such that $\theta^*(\alpha)\in  H^*(\kum{A}{n-1},\Z)$. Then $[\kum{A}{n-1}]\cdot\alpha \in H^*(A\hilb{n},\Z)$. 
\end{lemma}
\begin{proof}
The integrality of $\theta^*(\alpha)$ implies that, for all $\beta \in H^*(A\hilb{n},\Z)$,
$$
\int\limits_{\kum{A}{n-1}} \theta^*(\alpha)\cdot\theta^*(\beta) = \int\limits_{A\hilb{n}} [\kum{A}{n-1}]\cdot\alpha\cdot\beta
$$
is integral. Since the Poincar\'e pairing on $A\hilb{n}$ is unimodular, $[\kum{A}{n-1}]\cdot\alpha$ must be integral.
\end{proof}

\begin{proposition}
The kernel of $\theta^*$ is equal to the annihilator of $[\kum{A}{n-1}]$.
\end{proposition}
\begin{proof}
Assume $\alpha\in \ker(\theta^*)$. Then, for all $\beta \in H^*(A\hilb{n})$, we have
$$
\int\limits_{A\hilb{n}} [\kum{A}{n-1}]\cdot \alpha \cdot \beta = \int\limits_{\kum{A}{n-1}}\theta^*(\alpha)\cdot\theta^*(\beta) = 0.
$$
Since the Poincar\'e pairing on $A\hilb{n}$ is non-degenerate, this implies $ [\kum{A}{n-1}]\cdot \alpha=0$. 

Conversely, suppose that $ [\kum{A}{n-1}]\cdot \alpha=0$. Then, for all $\beta \in H^*(A\hilb{n})$, we have 
$$
\int\limits_{\kum{A}{n-1}}\theta^*(\alpha)\cdot\theta^*(\beta) = 0,
$$
so $\theta^*(\alpha) \in \im(\theta^*)\cap\im(\theta^*)^\perp$. The Poincar\'e pairing on $\kum{A}{n-1}$ is non-degenerate when restricted to $\im(\theta^*)$. To see this, observe that the dual element of $\theta^*(\alpha)$ in $\im(\theta^*)$ is given by $\theta^*(\alpha^*)$, where $\alpha^* $ is the Poincar\'e dual of $[\kum{A}{n-1}]\cdot \alpha$. So it follows that $\im(\theta^*)\cap\im(\theta^*)^\perp=0$.
\end{proof}
\begin{corollary} \label{KummerEquality}
$\theta^*(\alpha) = \theta^*(\beta)$ if and only if $[\kum{A}{n-1}]\cdot \alpha = [\kum{A}{n-1}]\cdot \beta$. 
\qed
\end{corollary}

\begin{proposition}
The annihilator of $[\kum{A}{n-1}]$ in $H^*(A\hilb{n},\Q)$ is the ideal generated by $H^1(A\hilb{n})$. 
\end{proposition}
\begin{proof}
Set $H=H^*(A,\Q)$ and consider the exact sequence of $H$-modules
$$
0 \longrightarrow H^{\geq 1}(A,\Q)  \longrightarrow H \stackrel{x\cdot}{\longrightarrow} H.
$$
It is clear that $H^{\geq 1}(A,\Q)$ is the ideal in $H$ generated by $H^{1}(A,\Q)$. 
Now denote $J^{(n)}$ the ideal generated by $H^1(\Sym^n(A),\Q)$ in $H^*(\Sym^n(A),\Q)\cong\SSym^n(H)$.
By the freeness result of Lemma \ref{SuperFree}, tensoring with $\SSym^n(H)$ yields another exact sequence of $H$-modules
$$
0 \longrightarrow {J}^{(n)} \longrightarrow \SSym^n(H) \xrightarrow{\sigma(x)\cdot} \SSym^n(H).
$$
Now let $\mathfrak{H}$ be the operator algebra spanned by products of $\mathfrak d$ and $\q_1(a)$ for $a\in H^*(A)$. Let $\mathfrak C$ be the graded commutative subalgebra of $\mathfrak H$ generated by $\q_1(a)$ for $a\in H^*(A)$. The action of $\mathfrak H$ on $\vac$ gives $\H$ and the action of $\mathfrak C$ on $\vac$ gives $\rho^*(H^*(\Sym^n(A),\Q))\cong \SSym^n(H)$.
By sending $\mathfrak d$ to the identity, we define a linear map $c : \mathfrak H \rightarrow \mathfrak C$. 
Denote $J\hilb{n}$ the ideal generated by $H^1(A\hilb{n},\Q)$ in $H^*(A \hilb n,\Q)$. We claim that for every $\mathfrak y\in \mathfrak H$:
$$
\mathfrak y\vac \in J\hilb{n} \Leftrightarrow c(\mathfrak y)\vac \in J\hilb{n}.
$$
To see this, we remark that $H^1(A \hilb n,\Q) \cong H^1(A ,\Q)  $ and the multiplication with a class in $H^1(A \hilb n,\Q) $ is given by the operator $\mathfrak G_0(a)$ for some $a\in H^1(A ,\Q)$. Due to the fact that $\mathfrak d$ is also a multiplication operator (of degree 2), $\mathfrak G_0(a)$ commutes with $\mathfrak d$. It follows that for $\mathfrak y =\mathfrak G_0(a) \mathfrak r$ we have $c(\mathfrak y) = \mathfrak G_0(a) c(\mathfrak r)$.

Now denote $\mathfrak k$ the multiplication operator with the class $[\kum{A}{n-1}]$. We have:
$
[\mathfrak k, \mathfrak d] = 0.
$
Now let $y\in H^*(A\hilb{n},\Q)$ be a class in the annihilator of $[\kum{A}{n-1}]$. We can write $y= \mathfrak y\vac$ for a $\mathfrak y\in\mathfrak H$. Choose $\tilde y \in \SSym^n (H)$ in a way that $\rho^*(\tilde y) = c(\mathfrak y) \vac$. Then we have:
$$
0=[\kum{A}{n-1}]\cdot y = \mathfrak k\, \mathfrak y \vac =  \mathfrak k \,c(\mathfrak y)\vac = \rho^*(\sigma^*(x) \cdot \tilde y).
$$
Since $\rho^*$ is injective, $\tilde y$ is in the annihilator of $\sigma^*(x)$, so $\tilde y \in J^{(n)}$. It follows that $c(\mathfrak y)\vac$ and $y$ are in the ideal generated by $H^1(A\hilb{n},\Q)$.
\end{proof}

\begin{theorem}\cite[Th\'eor\`eme 4]{Beauville}
$\kum{A}{n-1}$ is a irreducible holomorphically symplectic manifold. In particular, it is simply connected and the canonical bundle is trivial.
\end{theorem}
This implies that $H^2(\kum{A}{n-1},\Z)$ admits an integer-valued nondegenerated quadratic form (called Beauville--Bogomolov form) $q$ which gives $H^2(\kum{A}{n-1},\Z)$ the structure of a lattice. This lattice is
isomorphic to $U^{\oplus 3}\oplus \left< -2n \right>$, for $n\geq 3$. 

\textbf{TODO:} find a reference for Beauville-Bogomolov form

We have the following formula for $\alpha\in H^2(\kum{A}{n-1},\Z)$:
\begin{equation} \label{fujiki}
%\int_{\kum{A}{n-1}} \alpha^{2n-2} = n\frac{(2n-2)!}{2^{n-1}(n\! - \! 1)!} q(a)^{n-1}
\int_{\kum{A}{n-1}} \alpha^{2n-2} = n\cdot(2n-3)!!\cdot q(\alpha)^{n-1}
\end{equation}



\begin{proposition}\label{H2Sur} Assume $n\geq 3$. Then
$\theta^*$ is surjective on $H^2(A\hilb{n},\Z)$.
\end{proposition}
\begin{proof}
By \cite[Sect.~7]{Beauville}, $\theta^{\ast} : H^2(A\hilb{n},\C) \rightarrow H^2(\kum{A}{n-1},\C)$ is surjective. 
Then the idea is to prove that the lattice structure of $\im \theta^*$ is the same as of $H^2(\kum{A}{n-1})$.
We use two formulas in \cite[pp.~8--11]{Britze}. Let $b\in H^2(A,\Z)$ and set $\alpha = \frac{1}{(n-1)!}\kq_{1}(1)^{n-1}\kq_1(b)\vac\in H^2(A\hilb{n},\Z)$. Then  
\begin{equation} 
\int_{A\hilb{n}}\alpha^{2n} = \binom{2n}{2} \frac{\int_A b^2}{n^2} \int_{\kum{A}{n-1}} \theta^* \alpha^{2n-2}
%\int_{A\hilb{3}}j(a)^6 = \frac{5}{3} \int_A a^2 \int_{\kum{A}{2}} \theta^* j(a)^4
\end{equation}
By Proposition (TODO), the left hand side of this equation equals $(2n-1)!!\cdot \left(\int_a b^2\right)^n$. By (\ref{fujiki}), the right hand side gives $(2n-1)!! \cdot \left(\int_A b^2\right) \cdot q(\alpha)^{n-1}$. So
we get
$\int_A b^2 = q(\alpha)$, giving the set of all $\alpha$ a lattice structure isomorphic to $H^2(A,\Z)$. 
Secondly, we must show that for $\delta=$ half of the exceptional divisor: $q(\theta^*\delta) = -2n$. But this follows now from Proposition 1 in \cite{Britze}.
%Remark: $\theta^*\delta$ seems to be indivisible (because of (\ref{fujiki})), but every product with $\theta^*\delta$ is divisible by 3. Indeed, the value of (\ref{fujiki}) for $\alpha=\theta^*\delta$ is 324.
\end{proof}
\begin{notation}\label{BasisH2KA}
 We have seen that, for $n\geq 3$,
 $$
 H^2(\kum{A}{n-1},\Z) \cong H^2(A,\Z) \oplus\left<\theta^*(\delta)\right>.
 $$
We denote the injection $ : H^2(A,\Z) \rightarrow H^2(\kum{A}{n-1},\Z)$ by $j$. Further, we set $e:=\theta^*(\delta)$. We give the following names for classes in $H^2(\kum{A}{n-1},\Z)$:
\begin{align*}
u_1 &:= j(a_1 a_2), & v_1 &:= j(a_1 a_3), & w_1 &:= j(a_1 a_4), \\ 
u_2 &:= j(a_3 a_4), & v_2 &:= j(a_4 a_2), & w_2 &:= j(a_2 a_3),
\end{align*}
These elements form a basis of $H^2(\kum{A}{n-1},\Z)$ with the following intersection relations under the Beauville-Bogomolov form:
\begin{align*}
q(u_1,u_2) &= 1, & q(v_1,v_2) &= 1, & q(w_1,w_2) &= 1,  &
q(e,e)&= -2n,
\end{align*}
and all other pairs of basis elements are orthogonal.
\end{notation}


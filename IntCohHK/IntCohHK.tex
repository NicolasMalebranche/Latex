\documentclass{amsart}

\usepackage{amsmath,amssymb,amsfonts}
\usepackage[all]{xy}

\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\trace}{tr}
\DeclareMathOperator{\Tor}{Tor}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\im}{Im}
\DeclareMathOperator{\Ker}{Ker}
\DeclareMathOperator{\Sym}{Sym}
\DeclareMathOperator{\Hilb}{Hilb}

\newcommand{\hilb}[1]{^{[#1]}}
\newcommand{\ie}{{\it i.e. }}
\newcommand{\eg}{{\it e.g. }}
\newcommand{\loccit}{{\it loc. cit. }}
\newcommand{\ii}{{\rm i}}
\newcommand{\dual}[1]{{#1}\spcheck}
\newcommand{\abs}[1]{|{#1}|}
\newcommand{\Kummer}[2]{{#2}^{\llbracket#1\rrbracket}}
\newcommand{\vac}{|0\rangle}
\newcommand{\odd}{{\rm{odd}}}
\newcommand{\even}{{\rm{even}}}
\newcommand{\tors}{{\rm{tors}}}

\newcommand{\aG}{{\rm{a}}_G}
\newcommand{\mG}{{\rm{m}}_G}

% for spectral sequences

\newcommand{\coloneqq}{:=}

\makeatletter
\newcommand{\rmnum}[1]{\romannumeral #1}
\newcommand{\Rmnum}[1]{\expandafter\@slowromancap\romannumeral #1@}
\makeatother


\newcommand{\FI}{F_{\text{\Rmnum{1}}}}
\newcommand{\FII}{F_{\text{\Rmnum{2}}}}
\newcommand{\EI}{\text{}^{\text{\Rmnum{1}}}\!E}
\newcommand{\EII}{\text{}^{\text{\Rmnum{2}}}\!E}
\newcommand{\dI}{\text{}^{\text{\Rmnum{1}}}\!d}
\newcommand{\dII}{\text{}^{\text{\Rmnum{2}}}\!d}

% for total derived functors and hypercohomology

\newcommand{\HH}{\mathbf{H}}
\newcommand{\LL}{\mathbf{L}}
\newcommand{\RR}{\mathbf{R}}

% for equivariant cohomology

\newcommand{\BG}{BG}
\newcommand{\EG}{EG}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\IC}{\mathbb{C}}
\newcommand{\IR}{\mathbb{R}}
\newcommand{\IQ}{\mathbb{Q}}
\newcommand{\IZ}{\mathbb{Z}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\kS}{\mathfrak{S}}

\newcommand{\km}{\mathfrak{m}}
\newcommand{\kq}{\mathfrak{q}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\lra}{\longrightarrow}
\newcommand{\ra}{\rightarrow}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{notation}[theorem]{Notation}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\title[Products in $H^\ast(\Hilb^n(K3), \IZ)$]{Computing Cup-Products in integer cohomology of Hilbert schemes of points on K3 surfaces}


\author{Simon Kapfer}
\address{Simon Kapfer, Lehrstuhl f\"ur Algebra und Zahlentheorie, Universit\"ats\-stra{\ss}e~14, D-86159 Augsburg}
\email{simon.kapfer@math.uni-augsburg.de}
%\urladdr{http://www.math.uni-augsburg.de/alg/}


\date{\today}

%\subjclass{Primary 14J50, Secondary 14C50, 55T10}

%\keywords{}

\begin{abstract} 
We study the images of cup 
products in integer cohomology of the Hilbert scheme of $n$ points on a K3 surface. 
\end{abstract}

\maketitle


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Preliminaries}
\begin{definition}
Let $n$ be a natural number. A partition of $n$ is a sequence $\lambda = (\lambda_1\geq\ldots\geq\lambda_k>0)$ of natural numbers such that $\sum_i \lambda_i =n$. It is convenient to write $\lambda = (1^{m_1},2^{m_2},\ldots)$ as a sequence of multiplicities. We define the weight $\|\lambda\| :=\sum m_i i =n$ and the length $|\lambda| := \sum_i m_i =k$. We also define $z_\lambda \coloneqq\prod_i i^{m_i} m_i!$. 
\end{definition}
\begin{definition} \label{SymFun}
Let $\Lambda$ be the ring of symmetric functions. Let $m_\lambda$ and $p_\lambda$ denote the monomial and the power sum symmetric functions. They are both indexed by partitions and form a basis of $\Lambda$. They are linearly related by $p_\lambda = \sum_{\mu} \psi_{\lambda\mu}m_\mu$, the sum being over partitions with the same weight as $\lambda$, hence finite. The base change matrix $(\psi_{\lambda\mu})$ has integral entries, but its inverse $(\psi_{\lambda\mu}^{-1)}$ has not. For example, $p_{(2,1,1)} = 2m_{(2,1,1)} + 2m_{(2,2)}+2m_{(3,1)}+m_{(4)} $ but $ m_{(2,1,1)} = \frac{1}{2}p_{(2,1,1)} -\frac{1}{2}m_{(2,2)} -p_{(3,1)}+p_{(4)}$. A method to determine the coefficients $(\psi_{\lambda\mu})$ is given in \cite[Sect. 3.7]{Lascoux}.
\end{definition}
\begin{definition}
Let $S$ be a projective K3 surface. We fix integral bases $1$ of $H^0(S,\IZ)$, $x$ of $H^4(X,\IZ)$ and $\alpha_1,\ldots ,\alpha_{22}$ of $H^2(S,\IZ)$. The cup product induces a symmetric bilinear form $B_{H^2}$ on $H^2(X,\IZ)$ and thus the structure of a lattive isomorphic to $U^{\oplus 3}\oplus E_8(-1)^{\oplus 2}$, \ie three times the hyperbolic lattice and two times the negative $E_8$ lattice.
We may extend $B_{H^2}$ to a symmetric non-degenerate bilinear form on $H^\ast(S,\IZ)$ by setting $ B(1,1) = 0,\ B(1,\alpha_i) = 0,\ B(1,x) = 1, \ B(x,x) = 0$.
\end{definition}
\begin{definition}
$B$ induces a form $B\otimes B$ on $\Sym^2H^\ast(S,\IZ)$. So the cup-product 
\begin{equation*}
\mu : \Sym ^2H^{*}(S,\IZ) \longrightarrow H^\ast(S,\IZ) 
\end{equation*}
has an adjoint comultiplication $\Delta$ that is coassociative, given by:
\begin{equation*}
\Delta : H^\ast(S,\IZ) \longrightarrow \Sym^2H^\ast(S,\IZ),\quad \Delta = (B\otimes B)^{-1}\mu^TB
\end{equation*}
The image of 1 under the composite map $\mu(\Delta(1)) = B(\Delta(1),\Delta(1)) = 24 x$, denoted by $e$ is called the Euler Class.
\end{definition}
We denote by $S\hilb{n}$ the Hilbert scheme of $n$ points on $S$, \ie the classifying space of all zero-dimensional closed subschemes of length $n$, which is smooth. 
A classical result by Nakajima gives an explicit description of $H^\ast(S\hilb{n},\IQ)$ in terms of creation operators
$\kq_l(\beta)$, 
$\beta\in H^\ast(S,\IQ)$, acting on the direct sum 
$\bigoplus_n H^\ast(S\hilb{n},\IQ)$. 
An integral basis for $H^\ast(S\hilb{n},\IZ)$ in terms of Nakajima's operators was given by Qin--Wang:
\begin{theorem} \cite[Thm. 5.4.]{QinWang} Let $\km_{\nu,\alpha} := \sum_\rho \psi_{\nu\rho}^{-1}\,\kq(\alpha)$, with coefficients as in Definition \ref{SymFun}. The classes
$$ \frac{1}{z_\lambda} \kq_\lambda(1)\kq_\mu(x)\km_{\nu^1,\alpha_1}\ldots\km_{\nu^{22},\alpha_{22}}\vac,\quad \|\lambda\| +\|\mu\| + \sum_{i=1}^{22}\|\nu^i\| = n
$$ 
form an integral basis for $H^\ast(S\hilb{n},\IZ)$. Here,
$\lambda,\; \mu,\; \nu^i$ are partitions.
\end{theorem}
\begin{notation}
To enumerate the basis of $H^\ast(S\hilb{n},\IZ)$, we introduce the following abbreviation:
$$ 
1^\lambda \alpha_1^{\nu^1}\ldots\alpha_{22}^{\nu^{22}}x^\mu :=
\frac{1}{z_{\tilde{\lambda}} }
\kq_{\tilde{\lambda}}(1)\kq_\mu(x)\km_{\nu^1,\alpha_1}\ldots\km_{\nu^{22},\alpha_{22}}\vac
$$
where the partition $\tilde{\lambda}$ is built from $\lambda$ by appending sufficiently many Ones, such that $\|\tilde{\lambda}\| +\|\mu\| + \sum\|\nu^i\| = n $. If $\|\lambda\| +\|\mu\| + \sum\|\nu^i\| > n, $ we put $1^\lambda \alpha_1^{\nu^1}\ldots\alpha_{22}^{\nu^{22}}x^\mu =0$.
\end{notation}
The ring structure of $H^\ast(S\hilb{n}, \IQ)$ has been studied in \cite{LehnSorger}, where an explicit algebraic model is constructed, which we recall briefly:
\begin{definition} \cite[Sect. 2]{LehnSorger}
Let $\pi$ be a permutation of $n$ letters, written as a sum of disjoint cycles. To each cycle we may associate an element of $A:=H^\ast(S,\IQ)$. This defines an element in $A^{\otimes m}$, $m$ being the number of cycles. So these mappings span a vector space over $\IQ$. The space obtained by taking the direct sum over all $\pi \in S_n$ will be denoted by $A\{S_n\}$. 

To define a ring structure, take two permutations $\pi,\tau$, together with mappings. The result of the multiplication will be the permutation $\pi\tau$, together with a mapping of cycles. To construct the mappings to $A$, look first at the orbit space of the group of permutations $\left<\pi,\tau\right>$, generated by $\pi$ and $\tau$. For each cycle of $\pi, \tau$ contained in one orbit $B$ of $\left<\pi,\tau\right>$, multiply with the associated element of $A$. Also multiply with a certain power of the Euler class $e^g$. 
Afterwards, apply the comultiplication $\Delta$ repeatedly on the product to get a mapping from the cycles of $\pi\tau$ contained in $B$ to $A$. 
Here the "graph defect" $g$ is defined as follows: Let $u,v,w$ be the number of cycles contained in $B$ of $\pi,\;\tau,\;\pi\tau$, respectively. Then $g:=\frac{1}{2}\left(|B| + 2- u-v-w\right)$. Now follow this procedure for each orbit $B$. 

\end{definition}
The symmetric group $S_n$ acts on $A\{S_n\}$ by conjugation. This action preserves the ring structure. Therefore the space of invariants $A\hilb{n} := \left(A\{S_n\} \right)^{S_n}$ becomes a subring. The main theorem of Lehn and Sorger can now be stated:
\begin{theorem} \cite[Thm. 3.2.]{LehnSorger}
The following map is an isomorphism of rings:
\begin{align*}
H^\ast(S\hilb{n},\IQ) & \longrightarrow A\hilb{n} \\
\kq_{n_1}(\beta_1)\ldots \kq_{n_k}(\beta_k) \vac &\longmapsto \sum_{\sigma\in S_n} \sigma a \sigma^{{-}1} 
\end{align*}
with $n_1+\ldots + n_k =n$ and $a\in A\{S_n\} $ corresponds to an arbitrary permutation with $k$ cycles of lengths $n_1,\ldots,n_k$ that are associated to the classes $\beta_1,\ldots,\beta_k \in H^\ast(S,\IQ)$, respectively.
\end{theorem}

Since $H^\text{odd}(S\hilb{n},\IZ) = 0$ and $H^\text{even}(S\hilb{n},\IZ)$ is torsion-free by \cite{Markman}, we can apply these results to $H^\ast(S\hilb{n}, \IZ)$ to determine the multiplicative structure of cohomology with integer coefficients.

\section{Computational results} 
We now give some results in low degrees, obtained by computing multiplication matrices with respect to the integral basis and a then reducing to Smith normal form (both done by a computer).
\begin{remark}
Denote $h^k(S\hilb{n})$ the rank of $H^k(S\hilb{n},\IZ)$. We have:
\begin{itemize}
\item $h^2(S\hilb{n}) = 23 $ for $n\geq 2$.
\item $h^4(S\hilb{n}) = 276,\; 299,\; 300$ for $n=2,3, \geq 4$ resp.
\item $h^6(S\hilb{n}) = 23,\; 2554,\; 2852,\; 2875,\; 2876$ for $n=2,3,4,5,\geq6$ resp.
\end{itemize}
\end{remark}

The algebra generated by classes of degree 2 is an interesting object to study. For cohomology with complex coefficients, Verbitsky has proven in \cite{Verbitsky} that the cup product mapping from $\Sym^k H^2(S\hilb{n},\IC)$ to $H^{2k}(S\hilb{n},\IC)$ is injective for $k\leq n$. One concludes that this also holds for integral coefficients.
\begin{proposition} Studying the image of $\Sym^2H^2$ in $H^4$, we obtain: 
$$
\frac{H^4(S\hilb{2},\IZ)}{\Sym^2 H^2(S\hilb{2},\IZ)}  \cong \left(\frac{\IZ}{2\IZ}\right)^{\oplus 23} \oplus \frac{\IZ}{5\IZ}
$$
This was already known to Boissi\`{e}re, Nieper-Wi\ss kirchen and Sarti, \cite[Prop. 3]{BNS}.
$$
\frac{H^4(S\hilb{3},\IZ)}{\Sym^2 H^2(S\hilb{3},\IZ)} \cong \frac{\IZ}{3\IZ} \oplus \IZ^ {\oplus 23} 
$$
The torsion part of the quotient is generated by the integral class $1^{(3)}$.
$$
\frac{H^4(S\hilb{n},\IZ)}{\Sym^2 H^2(S\hilb{n},\IZ)} \cong  \IZ^ {\oplus 24}, \quad \text{for }n\geq 4.
$$
This was already proven by Markman, \cite[Thm. 1.10]{Markman2}.
\end{proposition}
\begin{proposition} Studying triple products of $H^2(S\hilb{n},\IZ)$, we get:
$$
\frac{H^6(S\hilb{2},\IZ)}{\Sym^3 H^2(S\hilb{2},\IZ)} \cong 
\frac{\IZ}{2\IZ}
$$
The quotient is generated by the integral class $1^{(2)}$.
$$
\frac{H^6(S\hilb{3},\IZ)}{\Sym^3 H^2(S\hilb{3},\IZ)} \cong  \left(\frac{\IZ}{2\IZ}\right)^{\oplus 230}\oplus \left(\frac{\IZ}{36\IZ}\right)^{\oplus 22}\oplus \frac{\IZ}{72\IZ} \oplus \IZ^{\oplus 507}
$$
$$
\frac{H^6(S\hilb{4},\IZ)}{\Sym^3 H^2(S\hilb{4},\IZ)} \cong  \frac{\IZ}{2\IZ} \oplus \IZ^{\oplus 552}
$$
For $n\geq 5$, the quotient is free.
\end{proposition}
We study now cup products between classes of degree 2 and 4. The case of $S\hilb{n}$ is of particular interest.
\begin{proposition} Comparing $H^2(S\hilb{n},\IZ) \cup H^4(S\hilb{n},\IZ) $ with $H^6(S\hilb{n},\IZ) $, we obtain:
\begin{align} 
\frac{H^6(S\hilb{2},\IZ) }{H^2(S\hilb{2},\IZ)\cup H^4(S\hilb{2},\IZ)} &= 0 
\\
\frac{H^6(S\hilb{3},\IZ)}{H^2(S\hilb{3},\IZ)\cup H^4(S\hilb{3},\IZ)} &\cong \left(\frac{\IZ}{3\IZ}\right)^{\oplus 22} \oplus \frac{\IZ}{3\IZ}
\\
\frac{H^6(S\hilb{4},\IZ)}{H^2(S\hilb{4},\IZ)\cup H^4(S\hilb{4},\IZ)} &\cong  \left(\frac{\IZ}{6\IZ}\right)^{\oplus 22}\oplus\frac{\IZ}{108\IZ} \oplus\frac{\IZ}{2\IZ} 
\\
\frac{H^6(S\hilb{5},\IZ)}{H^2(S\hilb{5},\IZ)\cup H^4(S\hilb{5},\IZ)} &\cong 
 \IZ^{\oplus 22} \oplus \IZ
\\
\frac{H^6(S\hilb{n},\IZ)}{H^2(S\hilb{n},\IZ)\cup H^4(S\hilb{n},\IZ)} &\cong 
 \IZ^{\oplus 22} \oplus \IZ\oplus\IZ, \ n\geq 6.
\end{align}
In each case, the first 22 parts of the quotient are generated by the integral classes 
 $$
\alpha_i^{(1,1,1)} -3\cdot \alpha_i^{(2,1)} + 3\cdot \alpha_i^{(3)}+ 3 \cdot 1^{(2)}\alpha_i^{(1,1)} -6\cdot 1^{(2)}\alpha_i^{(2)}+6\cdot 1^{(2,2)}\alpha_i^{(1)}-3\cdot 1^{(3)}\alpha_i^{(1)},
$$ 
for $ i=1\ldots 22$. Now define an integral class
\begin{align*}
K:=&\;\sum_{i\neq j} B(\alpha_i,\alpha_j)\left[\alpha_i^{(1,1)}\alpha_j^{(1)} - 2\cdot\alpha_i^{(2)}\alpha_j^{(1)}+\frac{3}{2}\cdot 1^{(2)}\alpha_i^{(1)}\alpha_j^{(1)} \right] +\\
+&\;\sum_{i}B(\alpha_i,\alpha_i)\left[\alpha_i^{(1,1,1)} - 2\cdot\alpha_i^{(2,1)} + \frac{3}{2}\cdot 1^{(2)}\alpha_i^{(1,1)} \right]+  x^{(2)}-1^{(2)}x^{(1)}.
\end{align*} 
In the case $n=3$, the last part of the quotient is generated by $K$. 
\\In the case $n=4$, the class $ 1^{(4)}$ generates the 2-torsion part and $K+38\cdot1^{(4)}$ generates the 108-torsion part.
\\In the case $n=5$, the last part of the quotient is generated by $K + 16\cdot 1^{(4)} - 21\cdot 1^{(3,2)}$.\\
If $n\geq 6$, the two last parts of the quotient are generated by some multiples of $K -\frac{4}{3}(45-n)1^{(2,2,2)} + (48-n)1^{(3,2)}$ and $K-\frac{1}{2}(40-n)1^{(2,2,2)}+ \frac{1}{4}(48-n)1^{(4)}$.
\end{proposition}


\bibliographystyle{amsplain}
\bibliography{BiblioAutIHS}


\end{document}

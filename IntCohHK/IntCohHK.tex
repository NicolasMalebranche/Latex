\documentclass{amsart}

\usepackage{amsmath,amssymb,amsfonts}
\usepackage[all]{xy}
\usepackage{appendix,listings}

\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\trace}{tr}
\DeclareMathOperator{\Tor}{Tor}
\DeclareMathOperator{\Ext}{Ext}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\im}{Im}
\DeclareMathOperator{\Ker}{Ker}
\DeclareMathOperator{\Sym}{Sym}
\DeclareMathOperator{\Hilb}{Hilb}

\newcommand{\hilb}[1]{^{[#1]}}
\newcommand{\ie}{{\it i.e. }}
\newcommand{\eg}{{\it e.g. }}
\newcommand{\loccit}{{\it loc. cit. }}
\newcommand{\ii}{{\rm i}}
\newcommand{\dual}[1]{{#1}\spcheck}
\newcommand{\abs}[1]{|{#1}|}
\newcommand{\Kummer}[2]{{#2}^{\llbracket#1\rrbracket}}
\newcommand{\vac}{|0\rangle}
\newcommand{\odd}{{\rm{odd}}}
\newcommand{\even}{{\rm{even}}}
\newcommand{\tors}{{\rm{tors}}}

\newcommand{\aG}{{\rm{a}}_G}
\newcommand{\mG}{{\rm{m}}_G}

\newcommand{\One}{1}

% for spectral sequences

\newcommand{\coloneqq}{:=}

\makeatletter
\newcommand{\rmnum}[1]{\romannumeral #1}
\newcommand{\Rmnum}[1]{\expandafter\@slowromancap\romannumeral #1@}
\makeatother


\newcommand{\FI}{F_{\text{\Rmnum{1}}}}
\newcommand{\FII}{F_{\text{\Rmnum{2}}}}
\newcommand{\EI}{\text{}^{\text{\Rmnum{1}}}\!E}
\newcommand{\EII}{\text{}^{\text{\Rmnum{2}}}\!E}
\newcommand{\dI}{\text{}^{\text{\Rmnum{1}}}\!d}
\newcommand{\dII}{\text{}^{\text{\Rmnum{2}}}\!d}

% for total derived functors and hypercohomology

\newcommand{\HH}{\mathbf{H}}
\newcommand{\LL}{\mathbf{L}}
\newcommand{\RR}{\mathbf{R}}

% for equivariant cohomology

\newcommand{\BG}{BG}
\newcommand{\EG}{EG}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\IC}{\mathbb{C}}
\newcommand{\IR}{\mathbb{R}}
\newcommand{\IQ}{\mathbb{Q}}
\newcommand{\IZ}{\mathbb{Z}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\kS}{\mathfrak{S}}

\newcommand{\km}{\mathfrak{m}}
\newcommand{\kq}{\mathfrak{q}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\lra}{\longrightarrow}
\newcommand{\ra}{\rightarrow}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{notation}[theorem]{Notation}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\title[Products in $H^\ast(\Hilb^n(K3), \IZ)$]{Computing Cup-Products in integral cohomology of Hilbert schemes of points on K3 surfaces}


\author{Simon Kapfer}
\address{Simon Kapfer, Lehrstuhl f\"ur Algebra und Zahlentheorie, Universit\"ats\-stra{\ss}e~14, D-86159 Augsburg}
\email{simon.kapfer@math.uni-augsburg.de}
%\urladdr{http://www.math.uni-augsburg.de/alg/}


\date{\today}

%\subjclass{Primary 14J50, Secondary 14C50, 55T10}

%\keywords{}

\begin{abstract} 

We study cup 
products in integral cohomology of the Hilbert scheme of $n$ points on a K3 surface and present a computer program for this purpose. In particular, we deal with the question, which classes can be represented by products of lower degrees.
\end{abstract}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

The Hilbert schemes of $n$ points on a complex surface parametrize all zero-dimensional subschemes of length $n$. Studying their rational cohomology, Nakajima \cite{Nakajima} was able to give an explicit description of the vector space structure in terms of the action of a Heisenberg algebra.
The Hilbert schemes of points on a K3 surface are one of the few known classes of Irreducible Holomorphic Symplectic Manifolds. Lehn and Sorger \cite{LehnSorger} developed an algebraic model to describe the cohomological ring structure. On the other hand, Qin and Wang \cite{QinWang} found a base for integral cohomology in the projective case. By combining these results, we are able to determine the structure of the cohomology rings of Hilbert schemes of $n$ points on a projective K3 with integral coefficients. 
For $n=2$, this was done by Boissi\`ere, Nieper-Wi{\ss}kirchen and Sarti \cite{BNS}, who applied their results to automorphism groups of prime order. When $n$ is increasing, the cohomology rings become very large, so we need the help of a computer. Our goal here is to give some characteristics for low degrees.

Denote by $S\hilb{3}$ the Hilbert scheme of 3 points on a projective K3 surface. We identify $\Sym^2H^2(S\hilb{3},\IZ)$ with its image in $H^4(S\hilb{3},\IZ)$ under the cup product mapping. 
\begin{theorem}
The cup product mappings for the Hilbert scheme of 3 points on a projective K3 surface have the following cokernels:
\begin{gather}
\frac{H^4(S\hilb{3},\IZ)}{\Sym^2 H^2(S\hilb{3},\IZ)}  \cong \frac{\IZ}{3\IZ} \oplus \IZ^ {\oplus 23}\\
\frac{H^6(S\hilb{3},\IZ)}{H^2(S\hilb{3},\IZ)\smile H^4(S\hilb{3},\IZ)} \cong \left(\frac{\IZ}{3\IZ}\right)^{\oplus 23}
\end{gather}
\end{theorem}
Let $U$ denote the hyperbolic lattice and $-E_8$ the negative $E_8$ lattice.
\begin{theorem}
The middle cohomology group $H^6(S\hilb{3},\IZ)$, with the lattice structure induced by the Poincar\'{e} pairing is isometric to $U^{\oplus 957}\oplus (-E_8)^{\oplus 80}$.
\end{theorem}
Although the case $n=3$ is most interesting for us, our computer program allows computations for arbitrary $n$. We give some numerical results results in Section \ref{CompSection}.\vspace{5pt}

\emph{Acknowledgements.} The author thanks Samuel~Boissi\`ere and Marc~Nieper-Wi{\ss}kirchen for their supervision and many helpful comments. He also thanks Gr\'{e}goire~Menet for stimulating proposals.
\section{Preliminaries}
\begin{definition}
Let $n$ be a natural number. A partition of $n$ is a sequence $\lambda = (\lambda_1\geq\ldots\geq\lambda_k>0)$ of natural numbers such that $\sum_i \lambda_i =n$. It is convenient to write $\lambda = (1^{m_1},2^{m_2},\ldots)$ as a sequence of multiplicities. We define the weight $\|\lambda\| :=\sum m_i i =n$ and the length $|\lambda| := \sum_i m_i =k$. We also define $z_\lambda \coloneqq\prod_i i^{m_i} m_i!$. 
\end{definition}
\begin{definition} \label{SymFun}
Let $\Lambda$ be the ring of symmetric functions. Let $m_\lambda$ and $p_\lambda$ denote the monomial and the power sum symmetric functions. They are both indexed by partitions and form a basis of $\Lambda$. They are linearly related by $p_\lambda = \sum_{\mu} \psi_{\lambda\mu}m_\mu$, the sum being over partitions with the same weight as $\lambda$. It turns out that the base change matrix $(\psi_{\lambda\mu})$ has integral entries, but its inverse $(\psi_{\lambda\mu}^{-1})$ has not. For example, $p_{(2,1,1)} = 2m_{(2,1,1)} + 2m_{(2,2)}+2m_{(3,1)}+m_{(4)} $ but $ m_{(2,1,1)} = \frac{1}{2}p_{(2,1,1)} -\frac{1}{2}p_{(2,2)} -p_{(3,1)}+p_{(4)}$. A method to determine the $(\psi_{\lambda\mu})$ is given by Lascoux in \cite[Sect. 3.7]{Lascoux}.
\end{definition}
\begin{definition}
A lattice $L$ is a free $\IZ$-module of finite rank, equipped with a non-degenerate symmetric integral bilinear form $B$. The lattice $L$ is called odd, if there exists a $v\in L$, such that $B(v,v)$ is odd, otherwise it is called even. 
If there exists a nonzero $v \in L$, such that $B(v,v)= 0$, the lattice is called indefinite. 
Choosing a base $\{e_i\}_i$ of our lattice, we can write $B$ as a symmetric matrix. $L$ is called unimodular, if the matrix $B$ has determinant $\pm 1$. 
The difference between the number of positive eigenvalues and the number of negative eigenvalues of $B$ (regarded as a matrix over $\IR$) is called the signature.
\end{definition}
There is the following classification theorem. See \cite[Chap. II]{milnor1973symmetric} for reference.
\begin{theorem}
Any two indefinite unimodular lattices $L$, $L'$ are isometric iff they have the same rank, signature and parity. Evenness implies that the signature is divisible by 8. 
In particular, if $L$ is odd, then $L$ possesses an orthogonal basis and is hence isometric to $\left<1\right>^{\oplus k}\oplus\left<-1\right>^{\oplus l}$ for some $k,l\geq 0$. If $L$ is even, then $L$ is isometric to $U^{\oplus k}\oplus (\pm E_8)^{\oplus l}$ for some $k,l\geq 0$.
\end{theorem}
\begin{definition}
Let $S$ be a projective K3 surface. We fix integral bases $\One$ of $H^0(S,\IZ)$, $x$ of $H^4(S,\IZ)$ and $\alpha_1,\ldots ,\alpha_{22}$ of $H^2(S,\IZ)$. The cup product induces a symmetric bilinear form $B_{H^2}$ on $H^2(S,\IZ)$ and thus the structure of a unimodular lattice.
We may extend $B_{H^2}$ to a symmetric non-degenerate bilinear form $B$ on $H^\ast(S,\IZ)$ by setting $ B(\One,\One) = 0,\ B(\One,\alpha_i) = 0,\ B(\One,x) = 1, \ B(x,x) = 0$.
\end{definition}
By the Hirzebruch index theorem, we know that $H^2(S,\IZ)$ has signature $-16$ and, by the classification theorem for indefinite unimodular lattices, is isomorphic to $U^{\oplus 3}\oplus (-E_8)^{\oplus 2}$.
\begin{definition}
$B$ induces a form $B\otimes B$ on $\Sym^2H^\ast(S,\IZ)$. So the cup-product 
\begin{equation*}
\mu : \Sym ^2H^{*}(S,\IZ) \longrightarrow H^\ast(S,\IZ) 
\end{equation*}
induces an adjoint comultiplication $\Delta$ that is coassociative, given by:
\begin{equation*}
\Delta : H^\ast(S,\IZ) \longrightarrow \Sym^2H^\ast(S,\IZ),\quad \Delta = (B\otimes B)^{-1}\mu^TB
\end{equation*}
with the property $B\left(\Delta(a),b\otimes c\right)=B\left(a,b\smile c\right)$. Note that this does not define a bialgebra structure.
The image of $\One$ under the composite map $\mu(\Delta(\One)) = B(\Delta(\One),\Delta(\One)) = 24 x$, denoted by $e$ is called the Euler Class.
\end{definition}
We denote by $S\hilb{n}$ the Hilbert scheme of $n$ points on $S$, \ie the classifying space of all zero-dimensional closed subschemes of length $n$. $S\hilb{0}$ consists of a single point and $S\hilb{1}=S$. Fogarty proved that the Hilbert scheme is a smooth variety.
A theorem by Nakajima gives an explicit description of the vector space structure of $H^\ast(S\hilb{n},\IQ)$ in terms of creation operators
$$
\kq_l(\beta) :  H^\ast(S\hilb{n},\IQ) \longrightarrow  H^{\ast+k+l-1}(S\hilb{n+l},\IQ)
,$$ 
where $\beta\in H^k(S,\IQ)$, acting on the direct sum 
$\mathbb{H}:=\bigoplus_n H^\ast(S\hilb{n},\IQ)$. The operators $\kq_l(\beta)$ are linear and commute with each other. The vacuum vector $\vac$ is defined as the generator of $H^0(S\hilb{0},\IQ)\cong\IQ$. The images of $\vac$ under the polynomial algebra generated by the creation operators span $\mathbb{H}$ as a vector space. 
It is convenient to abbreviate $\kq_{l_1}(\beta)\ldots\kq_{l_k}(\beta)=:\kq_\lambda(\beta)$, where the partition $\lambda$ is composed by the $l_i$. 

An integral basis for $H^\ast(S\hilb{n},\IZ)$ in terms of Nakajima's operators was given by Qin--Wang:
\begin{theorem} \cite[Thm. 5.4.]{QinWang} Let $\km_{\nu,\alpha} := \sum_\rho \psi_{\nu\rho}^{-1}\,\kq_{\rho}(\alpha)$, with coefficients $ \psi_{\nu\rho}^{-1}$ as in Definition \ref{SymFun}. The classes
$$ \frac{1}{z_\lambda} \kq_\lambda(1)\kq_\mu(x)\km_{\nu^1,\alpha_1}\ldots\km_{\nu^{22},\alpha_{22}}\vac,\quad \|\lambda\| +\|\mu\| + \sum_{i=1}^{22}\|\nu^i\| = n
$$ 
form an integral basis for $H^\ast(S\hilb{n},\IZ)$. Here,
$\lambda,\; \mu,\; \nu^i$ are partitions.
\end{theorem}
\begin{notation}
To enumerate the basis of $H^\ast(S\hilb{n},\IZ)$, we introduce the following abbreviation:
$$ \boldsymbol\alpha^{\boldsymbol\lambda} :=
\One^{\lambda^0} \alpha_1^{\lambda^1}\ldots\alpha_{22}^{\lambda^{22}}x^{\lambda^{23}} :=
\frac{1}{z_{\widetilde{\lambda^0}} }
\kq_{\widetilde{\lambda^0}}(\One)\kq_{\lambda^{23}}(x)\km_{\lambda^1,\alpha_1}\ldots\km_{\lambda^{22},\alpha_{22}}\vac
$$
where the partition $\widetilde{\lambda^0}$ is built from $\lambda^0$ by appending sufficiently many Ones, such that $\left\|\widetilde{\lambda^0}\right\| +\sum_{i\geq 1}\left\|\lambda^i\right\| = n $. If $\sum_{n\geq 0}\left\|\lambda^i\right\| > n, $ we put $\boldsymbol\alpha^{\boldsymbol\lambda}=0$. Thus we can interpret $\boldsymbol\alpha^{\boldsymbol\lambda}$ as an element of $H^\ast(S\hilb{n},\IZ)$ for arbitrary $n$. We say that the symbol $\boldsymbol\alpha^{\boldsymbol\lambda}$ is reduced, if $\lambda^0$ contains no Ones. We define also $\left\|\boldsymbol\lambda\right\| := \sum_{n\geq 0}\left\|\lambda^i\right\|$. 
\end{notation}
\begin{lemma}\label{degBound}
Let $\boldsymbol\alpha^{\boldsymbol\lambda}$ represent a class of cohomological degree $2k$. If $\boldsymbol\alpha^{\boldsymbol\lambda}$ is reduced, then $\frac{k}{2}\leq\left\|\boldsymbol{\lambda}\right\| \leq 2k$.
\begin{proof} This is a simple combinatorial observation. The lower bound is witnessed by $x^{(\frac{k}{2})}$ (if $k$ is even)  and the upper bound is witnessed by $\One^{(2^k)}$.
\end{proof}
\end{lemma}
The ring structure of $H^\ast(S\hilb{n}, \IQ)$ has been studied by Lehn and Sorger in \cite{LehnSorger}, where an explicit algebraic model is constructed, which we recall briefly:
\begin{definition} \cite[Sect. 2]{LehnSorger}
Let $\pi$ be a permutation of $n$ letters, written as a sum of disjoint cycles. To each cycle we may associate an element of $A:=H^\ast(S,\IQ)$. This defines an element in $A^{\otimes m}$, $m$ being the number of cycles. So these mappings span a vector space over $\IQ$. The space obtained by taking the direct sum over all $\pi \in S_n$ will be denoted by $A\{S_n\}$. 

To define a ring structure, take two permutations $\pi,\tau$, together with mappings. The result of the multiplication will be the permutation $\pi\tau$, together with a mapping of cycles. To construct the mappings to $A$, look first at the orbit space of the group of permutations $\left<\pi,\tau\right>$, generated by $\pi$ and $\tau$. For each cycle of $\pi, \tau$ contained in one orbit $B$ of $\left<\pi,\tau\right>$, multiply with the associated element of $A$. Also multiply with a certain power of the Euler class $e^g$. Afterwards, apply the comultiplication $\Delta$ repeatedly on the product to get a mapping from the cycles of $\pi\tau$ contained in $B$ to $A$. 
Here the "graph defect" $g$ is defined as follows: Let $u,v,w$ be the number of cycles contained in $B$ of $\pi,\;\tau,\;\pi\tau$, respectively. Then $g:=\frac{1}{2}\left(|B| + 2- u-v-w\right)$. Now follow this procedure for each orbit $B$. 

\end{definition}
The symmetric group $S_n$ acts on $A\{S_n\}$ by conjugation. This action preserves the ring structure. Therefore the space of invariants $A\hilb{n} := \left(A\{S_n\} \right)^{S_n}$ becomes a subring. The main theorem of \cite{LehnSorger} can now be stated:
\begin{theorem} \cite[Thm. 3.2.]{LehnSorger}
The following map is an isomorphism of rings:
\begin{align*}
H^\ast(S\hilb{n},\IQ) & \longrightarrow A\hilb{n} \\
\kq_{n_1}(\beta_1)\ldots \kq_{n_k}(\beta_k) \vac &\longmapsto \sum_{\sigma\in S_n} \sigma a \sigma^{{-}1} 
\end{align*}
with $n_1+\ldots + n_k =n$ and $a\in A\{S_n\} $ corresponds to an arbitrary permutation with $k$ cycles of lengths $n_1,\ldots,n_k$ that are associated to the classes $\beta_1,\ldots,\beta_k \in H^\ast(S,\IQ)$, respectively.
\end{theorem}

Since $H^\text{odd}(S\hilb{n},\IZ) = 0$ and $H^\text{even}(S\hilb{n},\IZ)$ is torsion-free by \cite{Markman}, we can apply these results to $H^\ast(S\hilb{n}, \IZ)$ to determine the multiplicative structure of cohomology with integer coefficients. It turns out, that it is somehow independent of $n$. More precisely, we have the following stability theorem, by Li, Qin and Wang:
\begin{theorem} \emph{(Derived from \cite[Thm.~2.1]{QinWang}).}
Let $Q_1,\ldots,Q_s$ be products of creation operators, \ie $Q_i = \prod_j \kq_{\lambda_{i,j}}(\beta_{i,j}) $ for some partitions $\lambda_{i,j}$ and classes $\beta_{i,j}\in H^\ast(S,\IZ)$. Set $n_i := \sum_j \left\|\lambda_{i,j}\right\|$.
Then the cup product 
$ \prod_{i=1}^s \left(\frac{1}{(n-n_i)!} \kq_{n-n_i}(1) \,Q_i \,\vac \right)$ is equal to a finite linear combination of classes of the form $\frac{1}{(n-m)!}\kq_{n-m}(1)\prod_j \kq_{\mu_{j}}(\gamma_{j})\vac$, with $\gamma\in H^\ast(S,\IZ)$, $m=\sum_j\left\|\mu_j\right\|$, whose coefficients are independent of $n$. We have the upper bound $m\leq\sum_i n_i$. 
\end{theorem}
\begin{corollary} \label{stabCor} Let $\boldsymbol{\alpha}^{\boldsymbol{\lambda}},\boldsymbol{\alpha}^{\boldsymbol{\mu}},\boldsymbol{\alpha}^{\boldsymbol{\nu}}$ be reduced. Assume $n\geq\left\|\boldsymbol\lambda\right\|,\left\|\boldsymbol\mu\right\| $. Then the coefficients $c^{\boldsymbol{\lambda\mu}}_{\boldsymbol{\nu}}$ of the cup product in $H^\ast(S\hilb{n},\IZ)$
$$\boldsymbol{\alpha}^{\boldsymbol{\lambda}} \smile
\boldsymbol{\alpha}^{\boldsymbol{\mu}}
= \sum_{\boldsymbol{\nu}} c^{\boldsymbol{\lambda\mu}}_{\boldsymbol{\nu}} \boldsymbol{\alpha}^{\boldsymbol{\nu}}
$$  
are polynomials in $n$ of degree at most $ \left\|\boldsymbol\lambda\right\|+\left\|\boldsymbol\mu\right\|-\left\|\boldsymbol\nu\right\|$.
\end{corollary}
\begin{proof} Set $Q_{\boldsymbol{\lambda}}:=  \kq_{\lambda^0}(1)\kq_{\lambda^{23}}(x)\prod_{1\leq j\leq 22}\kq_{\lambda^j}(\alpha_j)$ and $n_{\boldsymbol\lambda}:=\left\|\boldsymbol\lambda\right\|$. Then we have:
$\boldsymbol{\alpha}^{\boldsymbol{\lambda}} = \frac{1}{(n-n_{\boldsymbol\lambda})!\,z_{\lambda^0}}\kq_{n-n_{\boldsymbol\lambda}}(1)Q_{\boldsymbol\lambda}\vac$ and $
\boldsymbol{\alpha}^{\boldsymbol{\mu}}=\frac{1}{(n-n_{\boldsymbol\mu})!\,z_{\mu^0}}\kq_{n-n_{\boldsymbol\mu}}(1)Q_{\boldsymbol\mu}\vac $. 
Thus the coefficient $c^{\boldsymbol{\lambda\mu}}_{\boldsymbol{\nu}}$ in the product expansion is a constant, which depends on $ \left\|\boldsymbol\lambda\right\|,\left\|\boldsymbol\mu\right\|,\left\|\boldsymbol\nu\right\|$, but not on $n$, multiplied with $\frac{(n-n_{\boldsymbol\nu})!}{(n-m)!}$ for a certain $m\leq n_{\boldsymbol\lambda}+n_{\boldsymbol\mu}$. 
This is a polynomial of degree $m-n_{\boldsymbol\nu}\leq n_{\boldsymbol\lambda}+n_{\boldsymbol\mu}-n_{\boldsymbol\nu} =\left\|\boldsymbol\lambda\right\|+\left\|\boldsymbol\mu\right\|-\left\|\boldsymbol\nu\right\| $.
\end{proof}
\begin{remark}
The above condition,  $n\geq\left\|\boldsymbol\lambda\right\|,\left\|\boldsymbol\mu\right\| $,
seems to be unnecessary. In particular, if $\left\|\boldsymbol\nu\right\|\leq n<\max\left\{\left\|\boldsymbol\lambda\right\|,\left\|\boldsymbol\nu\right\|\right\}$, the polynomial $ c^{\boldsymbol{\lambda\mu}}_{\boldsymbol{\nu}}$ has a root at $n$.
\end{remark}
\begin{example}\label{example} Here are some explicit examples for illustration.
\begin{enumerate} \item $
\One^{(2,2)}\smile \alpha_i^{(2)} = 2\cdot \One^{(2)}\alpha_i^{(1)}x^{(1)} + \One^{(2,2)}\alpha_i^{(2)} + 2\cdot\One^{(2)}\alpha_i^{(3)} +\alpha_i^{(4)} $ for $i\in\{1..22\}$.
\item Let $i,j\in\{1\ldots 22\}$. 
If $i \neq j$, then $\alpha_i^{(2)}\smile\alpha_j^{(1)} = \alpha_i^{(2)}\alpha_j^{(1)} + 2B(\alpha_i,\alpha_j)\cdot x^{(1)}$. 
Otherwise, $\alpha_i^{(2)}\smile\alpha_i^{(1)} = \alpha_i^{(3)}+ \alpha_i^{(2,1)} + 2B(\alpha_i,\alpha_i)\cdot x^{(1)}$.
\item Set $\boldsymbol{\alpha}^{\boldsymbol{\lambda}} = \One^{(2)}$ and $\boldsymbol{\alpha}^{\boldsymbol{\nu}}=x^{(1)}$. Then $c^{\boldsymbol{\lambda\lambda}}_{\boldsymbol{\nu}} =n-1$.
\item Set $\boldsymbol{\alpha}^{\boldsymbol{\lambda}} = \One^{(2,2)}$ and $\boldsymbol{\alpha}^{\boldsymbol{\nu}}=x^{(1,1)}$. Then $c^{\boldsymbol{\lambda\lambda}}_{\boldsymbol{\nu}} =\frac{(n-3)(n-2)}{2}$.
\item \label{oddWitness} Let $i,j$ be indices, such that $B(\alpha_i,\alpha_j)=1,\ B(\alpha_i,\alpha_i)=0=B(\alpha_j,\alpha_j)$ and let $k\geq 0$. Set $\boldsymbol{\alpha}^{\boldsymbol{\lambda}} = \alpha_i^{(1)}\alpha_j^{(1)}x^{(1^k)}$ 
and $\boldsymbol{\alpha}^{\boldsymbol{\nu}}= x^{(1^{2k})}$. Then $c^{\boldsymbol{\lambda\lambda}}_{\boldsymbol{\nu}} =1$.
\end{enumerate}
\end{example}

\section{Computational results} \label{CompSection}
We now give some results in low degrees, obtained by computing multiplication matrices with respect to the integral basis. To get their cokernels, one has to reduce them to Smith normal form. Both was done using a computer.
\begin{remark}
Denote $h^k(S\hilb{n})$ the rank of $H^k(S\hilb{n},\IZ)$. We have:
\begin{itemize}
\item $h^2(S\hilb{n}) = 23 $ for $n\geq 2$.
\item $h^4(S\hilb{n}) = 276,\; 299,\; 300$ for $n=2,3, \geq 4$ resp.
\item $h^6(S\hilb{n}) = 23,\; 2554,\; 2852,\; 2875,\; 2876$ for $n=2,3,4,5,\geq6$ resp.
\end{itemize}
\end{remark}
The algebra generated by classes of degree 2 is an interesting object to study. For cohomology with complex coefficients, Verbitsky has proven in \cite{Verbitsky} that the cup product mapping from $\Sym^k H^2(S\hilb{n},\IC)$ to $H^{2k}(S\hilb{n},\IC)$ is injective for $k\leq n$. Since there is no torsion, one concludes that this also holds for integral coefficients.
\begin{proposition} We identify $\Sym^2H^2(S\hilb{n},\IZ)$ with its image in $H^4(S\hilb{n},\IZ)$ under the cup product mapping. Then: 
\begin{align}
\frac{H^4(S\hilb{2},\IZ)}{\Sym^2 H^2(S\hilb{2},\IZ)} & \cong \left(\frac{\IZ}{2\IZ}\right)^{\oplus 23} \oplus \frac{\IZ}{5\IZ},\\
\label{sym23}
\frac{H^4(S\hilb{3},\IZ)}{\Sym^2 H^2(S\hilb{3},\IZ)} & \cong \frac{\IZ}{3\IZ} \oplus \IZ^ {\oplus 23}, \\
\frac{H^4(S\hilb{n},\IZ)}{\Sym^2 H^2(S\hilb{n},\IZ)} & \cong  \IZ^ {\oplus 24}, \quad \text{for }n\geq 4.
\end{align}
The 3-torsion in (\ref{sym23}) part is generated by the integral class $1^{(3)}$.
\end{proposition}
\begin{remark}
The torsion in the case $n=2$ was also computed by Boissi\`{e}re, Nieper-Wi\ss kirchen and Sarti, \cite[Prop. 3]{BNS} using similar techniques.
For all the author knows, the result for $n=3$ is new.
The freeness result for $n\geq 4$ was already proven by Markman, \cite[Thm. 1.10]{Markman2}, using a completely different method. 
\end{remark}
\begin{proposition} For triple products of $H^2(S\hilb{n},\IZ)$, we have:
$$
\frac{H^6(S\hilb{2},\IZ)}{\Sym^3 H^2(S\hilb{2},\IZ)} \cong 
\frac{\IZ}{2\IZ}
$$
The quotient is generated by the integral class $\One^{(2)}$.
$$
\frac{H^6(S\hilb{3},\IZ)}{\Sym^3 H^2(S\hilb{3},\IZ)} \cong  \left(\frac{\IZ}{2\IZ}\right)^{\oplus 230}\oplus \left(\frac{\IZ}{36\IZ}\right)^{\oplus 22}\oplus \frac{\IZ}{72\IZ} \oplus \IZ^{\oplus 507}
$$
$$
\frac{H^6(S\hilb{4},\IZ)}{\Sym^3 H^2(S\hilb{4},\IZ)} \cong  \frac{\IZ}{2\IZ} \oplus \IZ^{\oplus 552}
$$
For $n\geq 5$, the quotient is free.
\end{proposition}
\begin{proof}
For the freeness result, it is enough to check the case $n=5$, since we have the canonical split inclusions $\kq_1(1) : H^k(S\hilb{n},\IZ)\hookrightarrow H^k(S\hilb{n+1},\IZ)$ for all $n,k$.
\end{proof}
We study now cup products between classes of degree 2 and 4. The case of $S\hilb{3}$ is of particular interest.
\begin{proposition} \label{p24}The cup product mapping $ : H^2(S\hilb{n},\IZ)\otimes H^4(S\hilb{n},\IZ) \rightarrow H^6(S\hilb{n},\IZ) $ is neither injective (unless $n=0$) nor surjective (unless $n\leq 2$). We have:
\begin{align} 
\frac{H^6(S\hilb{3},\IZ)}{H^2(S\hilb{3},\IZ)\smile H^4(S\hilb{3},\IZ)} &\cong \left(\frac{\IZ}{3\IZ}\right)^{\oplus 22} \oplus \frac{\IZ}{3\IZ}
\\
\frac{H^6(S\hilb{4},\IZ)}{H^2(S\hilb{4},\IZ)\smile H^4(S\hilb{4},\IZ)} &\cong  \left(\frac{\IZ}{6\IZ}\right)^{\oplus 22}\oplus\frac{\IZ}{108\IZ} \oplus\frac{\IZ}{2\IZ} 
\\
\frac{H^6(S\hilb{5},\IZ)}{H^2(S\hilb{5},\IZ)\smile H^4(S\hilb{5},\IZ)} &\cong 
 \IZ^{\oplus 22} \oplus \IZ
\\
\frac{H^6(S\hilb{n},\IZ)}{H^2(S\hilb{n},\IZ)\smile H^4(S\hilb{n},\IZ)} &\cong 
 \IZ^{\oplus 22} \oplus \IZ\oplus\IZ, \ n\geq 6.
\end{align}
In each case, the first 22 parts of the quotient are generated by the integral classes 
 $$
\alpha_i^{(1,1,1)} -3\cdot \alpha_i^{(2,1)} + 3\cdot \alpha_i^{(3)}+ 3 \cdot \One^{(2)}\alpha_i^{(1,1)} -6\cdot \One^{(2)}\alpha_i^{(2)}+6\cdot \One^{(2,2)}\alpha_i^{(1)}-3\cdot \One^{(3)}\alpha_i^{(1)},
$$ 
for $ i=1\ldots 22$. Now define an integral class
\begin{align*}
K:=&\;\sum_{i\neq j} B(\alpha_i,\alpha_j)\left[\alpha_i^{(1,1)}\alpha_j^{(1)} - 2\cdot\alpha_i^{(2)}\alpha_j^{(1)}+\frac{3}{2}\cdot \One^{(2)}\alpha_i^{(1)}\alpha_j^{(1)} \right] +\\
+&\;\sum_{i}B(\alpha_i,\alpha_i)\left[\alpha_i^{(1,1,1)} - 2\cdot\alpha_i^{(2,1)} + \frac{3}{2}\cdot \One^{(2)}\alpha_i^{(1,1)} \right]+  x^{(2)}-\One^{(2)}x^{(1)}.
\end{align*} 
In the case $n=3$, the last part of the quotient is generated by $K$. 
\\In the case $n=4$, the class $ \One^{(4)}$ generates the 2-torsion part and $K+38\cdot\One^{(4)}$ generates the 108-torsion part.
\\In the case $n=5$, the last part of the quotient is generated by $K + 16\cdot \One^{(4)} - 21\cdot \One^{(3,2)}$.\\
If $n\geq 6$, the two last parts of the quotient are generated by some multiples of $K -\frac{4}{3}(45-n)\One^{(2,2,2)} + (48-n)\One^{(3,2)}$ and $K-\frac{1}{2}(40-n)\One^{(2,2,2)}+ \frac{1}{4}(48-n)\One^{(4)}$.
\end{proposition}
\begin{proof} The last assertion for arbitrary $n$ follows from Corollary \ref{stabCor}. First observe that for $\boldsymbol{\alpha}^{\boldsymbol{\lambda}}\!\in\! H^2,\  \boldsymbol{\alpha}^{\boldsymbol{\mu}}\!\in\! H^4,\  \boldsymbol{\alpha}^{\boldsymbol{\nu}}\!\in\! H^6 $, we have $\left\| \boldsymbol\lambda\right\| \leq 2$, $\left\| \boldsymbol\mu\right\| \leq 4$ and $\left\| \boldsymbol\nu\right\| \geq 2,$ according to Lemma \ref{degBound}.
The coefficient of the cup product martix are thus polynomials of degree at most $2+4-2 =4$ and it suffices to compute only a finite number of instances for $n$. It turns out that the maximal degree is $1$ and the cokernel of the multiplication map is given as stated.
\end{proof}
\begin{remark}
Observe that the generators of the quotients are independent of the choice of the base of $H^2(S,\IZ)$.

\end{remark}

In what follows, we compare some well-known facts about Hilbert schemes of points on K3 surfaces with our numerical calculations. This means, we have some tests that may justify the correctness of our computer program.
We start with computational results for the middle cohomology group. Since $S\hilb{n}$ is a projective variety of complex dimension $2n$, Poincar\'{e} duality gives $H^{2n}(S\hilb{n},\IZ)$ the structure of an unimodular lattice.  
\begin{proposition} Let $L$ denote the unimodular lattice $H^{2n}(S\hilb{n},\IZ)$. We have:
\begin{enumerate}
\item For $n=2$, $L$ is an odd lattice of rank $276$ and signature $156$.
\item For $n=3$, $L$ is an even lattice of rank $2554$ and signature $-1152$.
\item For $n=4$, $L$ is an odd lattice of rank $19298$ and signature $7082$.
\end{enumerate}
For $n$ even, $L$ is always odd. 
\end{proposition} 
\begin{proof}The numerical results come from an explicit calculation. For $n$ even, we always have the norm-1-vector given by Example \ref{example} (\ref{oddWitness}), so $L$ is odd. To obtain the signature, we could equivalently use Hirzebruch's signature theorem and compute the L-genus of $S\hilb{n}$. For the signature, we need nothing but the Pontryagin numbers, which can be derived from the Chern numbers of $S\hilb{n}$. These in turn are known by Ellingsrud, G\"ottsche and Lehn, \cite[Rem. 5.5]{EGL}. 
\end{proof}

\input{IntCode}

\bibliographystyle{amsplain}
\bibliography{BiblioAutIHS}


\end{document}
